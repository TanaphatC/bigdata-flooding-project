{"paragraphs":[{"title":"1.1) Hourly rainfall rate dataset importing from HUE","text":"%pyspark\r\nhourlyData = spark.read.csv(\"/user/zeppelin/flooding_data/rainfall_hourly_data2.csv\", header=True, inferSchema=True)","user":"anonymous","dateUpdated":"2020-11-07T07:38:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=523","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=524"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1602925411281_1573475665","id":"20201017-090331_940034940","dateCreated":"2020-10-17T09:03:31+0000","dateStarted":"2020-11-07T07:38:07+0000","dateFinished":"2020-11-07T07:38:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9161","results":{"code":"SUCCESS","msg":[]}},{"title":"1.2) Hourly water level rate dataset importing from HUE","text":"%pyspark\nfrom pyspark.sql.functions import lit\n\nwaterLevelBKK001DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK001.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK001\"))\nwaterLevelBKK003DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK003.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK003\"))\nwaterLevelBKK004DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK004.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK004\"))\nwaterLevelBKK005DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK005.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK005\"))\nwaterLevelBKK008DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK008.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK008\"))\nwaterLevelBKK009DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK009.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK009\"))\nwaterLevelBKK020DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK020.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK020\"))\nwaterLevelBKK021DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK021.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK021\"))\nwaterLevelCPY015DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_CPY015.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"CPY015\"))","user":"anonymous","dateUpdated":"2020-11-07T07:38:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=525","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=526","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=527","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=528","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=529","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=530","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=531","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=532","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=533","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=534","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=535","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=536","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=537","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=538","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=539","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=540","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=541","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=542"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604220295277_774090316","id":"20201101-084455_903609208","dateCreated":"2020-11-01T08:44:55+0000","dateStarted":"2020-11-07T07:38:09+0000","dateFinished":"2020-11-07T07:38:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9162","results":{"code":"SUCCESS","msg":[]}},{"title":"2.1) Data Preprocessing - Filter only Bangkok","text":"%pyspark\n#filter only \"Bangkok\" province and assign to valiable 'bangkokHourlyData'\nbangkokHourlyData = hourlyData.filter(hourlyData['province_name_en']==\"Bangkok\").select(hourlyData['station_id'], hourlyData['province_name_en'], hourlyData['district'], hourlyData['sub_district'], hourlyData['date'],  hourlyData['H01'], hourlyData['H02'], hourlyData['H03'], hourlyData['H04'], hourlyData['H05'], hourlyData['H06'], hourlyData['H07'], hourlyData['H08'], hourlyData['H09'], hourlyData['H10'], hourlyData['H11'], hourlyData['H12'], hourlyData['H13'], hourlyData['H14'], hourlyData['H15'], hourlyData['H16'], hourlyData['H17'], hourlyData['H18'], hourlyData['H19'], hourlyData['H20'], hourlyData['H21'], hourlyData['H22'], hourlyData['H23'], hourlyData['H24'])\n","user":"anonymous","dateUpdated":"2020-11-07T07:38:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"province_name_en","visible":true,"width":"*","sort":{"direction":"asc","priority":0},"filters":[{}],"pinned":""},{"name":"district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"sub_district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H01","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H02","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H03","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H04","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H05","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H06","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H07","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H08","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H09","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H10","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H11","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H12","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H13","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H14","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H15","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H16","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H17","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H18","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H19","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H20","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H21","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H22","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H23","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H24","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[{"field":"province_name_en","groupPriority":0,"colName":"province_name_en"}],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1602925420895_-1295208824","id":"20201017-090340_1507830950","dateCreated":"2020-10-17T09:03:40+0000","dateStarted":"2020-11-07T07:38:25+0000","dateFinished":"2020-11-07T07:38:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9163","results":{"code":"SUCCESS","msg":[]}},{"title":"2.2) Missing Value (Statistical value of known data): calculate average rainy rate of each that day","text":"%pyspark\n#calculate the number of rainy hours on that day. (rainy hour = 24 - dry hour)\nimport datetime\n\nrainyHourArray = []\n\nclass RainyHour:\n    \n    def __init__(self, district, subDistrict, date, totalRainyHour, summaryRainyRate):\n        self.key = str(abs(hash(district+subDistrict)))\n        self.location = str(district + \"/\" + subDistrict)\n        self.day = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n        self.month = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n        self.year = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n        self.totalRainyHour = totalRainyHour\n        self.summaryRainyRate = summaryRainyRate\n        self.averageRainyRate = self.calAvg()\n    \n    def info(self):\n        return (self.key, self.location, self.day, self.month, self.year, self.totalRainyHour, self.summaryRainyRate, self.averageRainyRate)\n    \n    def calAvg(self):\n        if self.totalRainyHour!=0 and self.summaryRainyRate>0.0: \n            return round(self.summaryRainyRate / self.totalRainyHour, 2)\n        else:\n            return 0\n\ndef calculateRainyHour(row):\n    rainyHour=24\n    summaryRainyRate = 0.0\n    \n    for i in range(1, 25):\n        colName= \"H0\"+str(i) if i<=9 else \"H\"+str(i)\n        \n        if row[colName]!=\"NULL\" and float(row[colName])==0.0:\n            rainyHour-=1\n\n        if row[colName]!=\"NULL\" : summaryRainyRate+=float(row[colName])\n            \n    return RainyHour(row['district'], row['sub_district'], row['date'], rainyHour, summaryRainyRate)\n\n\nfor row in bangkokHourlyData.rdd.collect():\n    r = calculateRainyHour(row)\n    rainyHourArray.append(r.info())\n\ndef getAvgRainyRateByLocationAndDate(district, subDistrict, date):\n    row = 0.0\n    keyIn = str(abs(hash(district+subDistrict)))\n    dayIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n    monthIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n    yearIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n    \n    for r in rainyHourArray:\n        if r[0]==keyIn and r[2]==dayIn and r[3]==monthIn and r[4]==yearIn:\n            row =  r[7]\n    \n    return row\n    ","user":"anonymous","dateUpdated":"2020-11-07T07:38:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"yAxis":{"name":"NumberOfRainyHour","index":3,"aggr":"sum"},"size":{"name":"Location","index":1,"aggr":"sum"},"xAxis":{"name":"Location","index":1,"aggr":"sum"}},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=543"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603029858134_-1147608560","id":"20201018-140418_1176902503","dateCreated":"2020-10-18T14:04:18+0000","dateStarted":"2020-11-07T07:38:25+0000","dateFinished":"2020-11-07T07:38:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9164","results":{"code":"SUCCESS","msg":[]}},{"title":"2.3) Missing value (Statistical value of known data) - Replace NULL with average rainy rate of each that day","text":"%pyspark\ndef replaceNullWithAvg(row):\n    avgRainyRate = getAvgRainyRateByLocationAndDate(row['district'], row['sub_district'], row['date'])\n    return (\n        float(avgRainyRate if row['H01']==\"NULL\" else row['H01']),\n        float(avgRainyRate if row['H02']==\"NULL\" else row['H02']),\n        float(avgRainyRate if row['H03']==\"NULL\" else row['H03']),\n        float(avgRainyRate if row['H04']==\"NULL\" else row['H04']),\n        float(avgRainyRate if row['H05']==\"NULL\" else row['H05']),\n        float(avgRainyRate if row['H06']==\"NULL\" else row['H06']),\n        float(avgRainyRate if row['H07']==\"NULL\" else row['H07']),\n        float(avgRainyRate if row['H08']==\"NULL\" else row['H08']),\n        float(avgRainyRate if row['H09']==\"NULL\" else row['H09']),\n        float(avgRainyRate if row['H10']==\"NULL\" else row['H10']),\n        float(avgRainyRate if row['H11']==\"NULL\" else row['H11']),\n        float(avgRainyRate if row['H12']==\"NULL\" else row['H12']),\n        float(avgRainyRate if row['H13']==\"NULL\" else row['H13']),\n        float(avgRainyRate if row['H14']==\"NULL\" else row['H14']),\n        float(avgRainyRate if row['H15']==\"NULL\" else row['H15']),\n        float(avgRainyRate if row['H16']==\"NULL\" else row['H16']),\n        float(avgRainyRate if row['H17']==\"NULL\" else row['H17']),\n        float(avgRainyRate if row['H18']==\"NULL\" else row['H18']),\n        float(avgRainyRate if row['H19']==\"NULL\" else row['H19']),\n        float(avgRainyRate if row['H20']==\"NULL\" else row['H20']),\n        float(avgRainyRate if row['H21']==\"NULL\" else row['H21']),\n        float(avgRainyRate if row['H22']==\"NULL\" else row['H22']),\n        float(avgRainyRate if row['H23']==\"NULL\" else row['H23']),\n        float(avgRainyRate if row['H24']==\"NULL\" else row['H24'])\n    )\n\ndef extract(row):\n    rowDate = row['date']\n    day = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().day)\n    month = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().month)\n    year = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().year)\n    \n    return (\n        row['station_id'], row['district'] + \"/\" + row['sub_district'], day, month, year, replaceNullWithAvg(row)\n    )\n\n\ncleanDF=bangkokHourlyData.rdd.map(extract).toDF(['StationId', 'Location','Day','Month', 'Year', 'RainyRates'])\n","user":"anonymous","dateUpdated":"2020-11-07T07:39:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Day","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Month","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"RainyHours","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyHours":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"scatterChart":{"xAxis":{"name":"Location","index":0,"aggr":"sum"}}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"Month","index":2,"aggr":"sum"}],"values":[{"name":"RainyHours","index":4,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=544"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603523563777_1375166502","id":"20201024-071243_435153083","dateCreated":"2020-10-24T07:12:43+0000","dateStarted":"2020-11-07T07:39:18+0000","dateFinished":"2020-11-07T07:39:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9165","results":{"code":"SUCCESS","msg":[]}},{"title":"2.4) Missing value - Check rainy rate since 01:00 till 24:00 should not be NULL","text":"%pyspark\nfor row in cleanDF.rdd.collect():\n    hourRow = row['RainyRates']\n    for i in range(0, 23):\n        assert \"True\" == str((hourRow[i] != \"NULL\"))","user":"anonymous","dateUpdated":"2020-11-07T07:39:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=545"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603611944566_-1555939565","id":"20201025-074544_914445690","dateCreated":"2020-10-25T07:45:44+0000","dateStarted":"2020-11-07T07:39:22+0000","dateFinished":"2020-11-07T07:39:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9166","results":{"code":"SUCCESS","msg":[]}},{"title":"2.5) Preprocessing - Extract calendar column to day, month, year column on water-level dataset","text":"%pyspark\nimport datetime\nfrom pyspark.sql import Row\n\nmonthsArray = [\"none\", \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\ndef extract(row):\n    rowDate = str(row['date'])[:10]\n    day = str(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().day)\n    month = int(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().month)\n    year = str(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().year)\n    \n    return (\n        row['station'], day, month, monthsArray[(month)], year, row['time'], float(row['water_lv'])\n    )\n   \nwaterLevelBKK001ExtractDF = waterLevelBKK001DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK003ExtractDF = waterLevelBKK003DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK004ExtractDF = waterLevelBKK004DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK005ExtractDF = waterLevelBKK005DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK008ExtractDF = waterLevelBKK008DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK009ExtractDF = waterLevelBKK009DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK020ExtractDF = waterLevelBKK020DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK021ExtractDF = waterLevelBKK021DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelCPY015ExtractDF = waterLevelCPY015DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])","user":"anonymous","dateUpdated":"2020-11-07T07:39:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=546","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=547","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=548","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=549","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=550","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=551","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=552","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=553","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=554"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604223467973_563099537","id":"20201101-093747_766830479","dateCreated":"2020-11-01T09:37:47+0000","dateStarted":"2020-11-07T07:39:28+0000","dateFinished":"2020-11-07T07:39:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9167","results":{"code":"SUCCESS","msg":[]}},{"title":"2.6) Cleansing Data - Replease abnormal value -999 of water-level","text":"%pyspark\nfrom pyspark.sql import Row\n\ndef replaseAbnormalWaterLevel(row):\n    waterLv = row['WaterLavel'] \n    if float(row['WaterLavel'])==float(-999):\n        waterLv = 0.0\n    return (\n        row['Station'], row['Day'], row['Month'] ,row['MonthName'], row['Year'], row['Time'], waterLv\n    )\n\nwaterLevelBKK001CleanDF = waterLevelBKK001ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station', 'Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK003CleanDF = waterLevelBKK003ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK004CleanDF = waterLevelBKK004ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK005CleanDF = waterLevelBKK005ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK008CleanDF = waterLevelBKK008ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK009CleanDF = waterLevelBKK009ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK020CleanDF = waterLevelBKK020ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK021CleanDF = waterLevelBKK021ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelCPY015CleanDF = waterLevelCPY015ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\n","user":"anonymous","dateUpdated":"2020-11-07T07:39:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Day":"string","Month":"string","MonthName":"string","Year":"string","Time":"string","WaterLavel":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=555","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=556","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=557","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=558","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=559","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=560","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=561","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=562","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=563"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604658398055_1755192589","id":"20201106-102638_1559502730","dateCreated":"2020-11-06T10:26:38+0000","dateStarted":"2020-11-07T07:39:33+0000","dateFinished":"2020-11-07T07:39:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9168","results":{"code":"SUCCESS","msg":[]}},{"title":"3.1) Mapping - Finding summary and average rainy rate each that day","text":"%pyspark\n\nmonthsArray = [\"none\", \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\ndef summaryRainyRate(row):\n    summaryRate = 0.0\n    hourRow = row['RainyRates']\n    result = [ row['StationId'], row['Location'], row['Day'], str(row['Month']), monthsArray[int(row['Month'])], row['Year'], row['RainyRates'], ]\n    for i in range(0, 23):\n        summaryRate+=hourRow[i]\n    result.append(round(float(summaryRate), 2))\n    return result\n    \nsummaryDF = cleanDF.rdd.map(summaryRainyRate).toDF([\"StationId\", \"Location\",\"Day\", \"MonthNo\", \"MonthName\" ,\"Year\",\"RainyRate\", \"DayRainyRate\"]).sort('DayRainyRate', ascending=False)\nsummaryDF.show()\n","user":"anonymous","dateUpdated":"2020-11-07T07:45:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyRate":"string","SummaryRainyRate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=587","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=588"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603622037681_330666540","id":"20201025-103357_826461112","dateCreated":"2020-10-25T10:33:57+0000","dateStarted":"2020-11-07T07:45:48+0000","dateFinished":"2020-11-07T07:45:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9169","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------------+---+-------+---------+----+--------------------+------------+\n|StationId|            Location|Day|MonthNo|MonthName|Year|           RainyRate|DayRainyRate|\n+---------+--------------------+---+-------+---------+----+--------------------+------------+\n|  4550006|Khlong Sam Wa/Sam...|  1|      5|      May|2014|[0.0, 0.0, 2.13, ...|      113.21|\n|  4550014|Nong Chok/Krathum...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       61.06|\n|  4550003|Lak Si/Thung Song...|  8|      5|      May|2014|[0.0, 4.54, 3.95,...|       58.82|\n|  4550004| Bang Khen/Tha Raeng|  8|      5|      May|2014|[0.0, 0.0, 4.4, 2...|       58.12|\n|  4550004| Bang Khen/Tha Raeng|  1|      5|      May|2014|[0.0, 0.0, 1.14, ...|       56.15|\n|  4550025|Bang Khun Thian/S...|  1|      5|      May|2014|[0.0, 0.0, 4.67, ...|       56.01|\n|  4550023|Lat Krabang/Lam P...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       55.55|\n|  4550007|Nong Chok/Khu Fan...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       53.81|\n|  4550024|   Bang Bon/Bang Bon|  8|      5|      May|2014|[3.34, 0.1, 0.72,...|       52.82|\n|  4550022|     Prawet/Nong Bon|  8|      5|      May|2014|[3.88, 2.26, 4.72...|       52.53|\n|  4550026|Bang Khun Thian/T...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 2...|       51.51|\n|  4550015|Phaya Thai/Sam Se...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 4...|       51.07|\n|  4550005|Khlong Sam Wa/Sam...|  8|      5|      May|2014|[0.0, 2.19, 0.61,...|        50.6|\n|  4550003|Lak Si/Thung Song...|  1|      5|      May|2014|[0.0, 0.0, 0.28, ...|       49.84|\n|  4550028|Khlong Toei/Khlon...| 28|      7|     July|2014|[0.0, 0.0, 0.0, 0...|        49.5|\n|  4550014|Nong Chok/Krathum...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 0...|       46.65|\n|  4550024|   Bang Bon/Bang Bon|  1|      5|      May|2014|[0.0, 0.0, 4.17, ...|       42.91|\n|  4550027|Khlong Toei/Khlon...| 22|      3|    March|2014|[0.0, 0.0, 0.0, 0...|        41.8|\n|  4550025|Bang Khun Thian/S...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 0...|       40.79|\n|  4550005|Khlong Sam Wa/Sam...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 1...|       40.65|\n+---------+--------------------+---+-------+---------+----+--------------------+------------+\nonly showing top 20 rows\n\n"}]}},{"title":"4.1) Reduce - Summary rainy rate by month and year","text":"%pyspark\ngroupByMYDF = summaryDF.groupBy([\"StationId\", \"Location\", \"MonthName\", \"MonthNo\", \"Year\"]).sum(\"DayRainyRate\")\nz.show(groupByMYDF)","user":"anonymous","dateUpdated":"2020-11-07T07:48:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":492,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"StationId":"string","Location":"string","MonthName":"string","MonthNo":"string","Year":"string","sum(DayRainyRate)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"yAxis":{"name":"sum(DayRainyRate)","index":5,"aggr":"sum"},"size":{"name":"sum(DayRainyRate)","index":5,"aggr":"sum"},"xAxis":{"name":"MonthNo","index":3,"aggr":"sum"},"group":{"name":"Location","index":1,"aggr":"sum"}},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","style":"stack"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","isDateFormat":false,"lineWithFocus":false,"forceY":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","stacked":true},"pieChart":{}},"keys":[],"groups":[],"values":[],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":93,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=589","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=590","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=591","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=592","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=593","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=594"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603624634837_-122743207","id":"20201025-111714_732506377","dateCreated":"2020-10-25T11:17:14+0000","dateStarted":"2020-11-07T07:46:16+0000","dateFinished":"2020-11-07T07:46:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9170","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"StationId\tLocation\tMonthName\tMonthNo\tYear\tsum(DayRainyRate)\n4550019\tLat Krabang/Khlong Sam Prawet\tFebruary\t2\t2014\t22.789999999999996\n4550025\tBang Khun Thian/Samae Dam\tJanuary\t1\t2014\t30.98\n4550004\tBang Khen/Tha Raeng\tMay\t5\t2014\t114.27\n4550018\tSaphan Sung/Saphan Sung\tMay\t5\t2014\t40.63\n4550016\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t18.509999999999998\n4550004\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t0.0\n4550026\tBang Khun Thian/Tha Kham\tMarch\t3\t2014\t5.92\n4550026\tBang Khun Thian/Tha Kham\tApril\t4\t2014\t4.58\n4550027\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t38.4\n4550014\tNong Chok/Krathum Rai\tJanuary\t1\t2014\t15.510000000000002\n4550001\tDon Mueang/Sanam Bin\tMarch\t3\t2014\t13.91\n4550018\tSaphan Sung/Saphan Sung\tApril\t4\t2014\t19.36\n4550024\tBang Bon/Bang Bon\tApril\t4\t2014\t8.02\n4550011\tBueng Kum/Khlong Kum\tJanuary\t1\t2014\t6.42\n4550011\tBueng Kum/Khlong Kum\tMay\t5\t2014\t18.6\n4550010\tLat Phrao/Lat Phrao\tFebruary\t2\t2014\t3.64\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t5\t2014\t151.48\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t3\t2014\t20.49\n4550002\tNong Chok/Khlong Sip Song\tApril\t4\t2014\t14.66\n4550019\tLat Krabang/Khlong Sam Prawet\tMarch\t3\t2014\t14.89\n4550013\tNong Chok/Lam Phak Chi\tMarch\t3\t2014\t34.99\n4550019\tLat Krabang/Khlong Sam Prawet\tJanuary\t1\t2014\t16.009999999999998\n4550023\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t27.790000000000003\n4550019\tLat Krabang/Khlong Sam Prawet\tApril\t4\t2014\t6.6\n4550008\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t1.89\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t4\t2014\t5.3500000000000005\n4550028\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t11.15\n4550008\tBang Khen/Tha Raeng\tApril\t4\t2014\t2.45\n4550028\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t46.400000000000006\n4550027\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.0\n4550021\tBang Khae/Bang Phai\tFebruary\t2\t2014\t5.59\n4550020\tLat Krabang/Khum Thong\tFebruary\t2\t2014\t12.020000000000001\n4550017\tHuai Khwang/Bang Kapi\tJanuary\t1\t2014\t3.6999999999999997\n4550022\tPrawet/Nong Bon\tMay\t5\t2014\t80.8\n4550016\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t9.11\n4550011\tBueng Kum/Khlong Kum\tMarch\t3\t2014\t12.540000000000001\n4550007\tNong Chok/Khu Fang Nuea\tApril\t4\t2014\t16.330000000000002\n4550017\tHuai Khwang/Bang Kapi\tMay\t5\t2014\t14.3\n4550024\tBang Bon/Bang Bon\tJanuary\t1\t2014\t9.57\n4550021\tBang Khae/Bang Phai\tApril\t4\t2014\t4.41\n4550028\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.8\n4550008\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t5.16\n4550027\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.9\n4550020\tLat Krabang/Khum Thong\tApril\t4\t2014\t8.02\n4550012\tMin Buri/Saen Saep\tJanuary\t1\t2014\t8.17\n4550003\tLak Si/Thung Song Hong\tFebruary\t2\t2014\t12.719999999999999\n4550001\tDon Mueang/Sanam Bin\tMay\t5\t2014\t13.2\n4550015\tPhaya Thai/Sam Sen Nai\tFebruary\t2\t2014\t11.930000000000001\n4550015\tPhaya Thai/Sam Sen Nai\tJanuary\t1\t2014\t11.120000000000001\n4550007\tNong Chok/Khu Fang Nuea\tFebruary\t2\t2014\t3.2199999999999998\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t3\t2014\t16.88\n4550015\tPhaya Thai/Sam Sen Nai\tMarch\t3\t2014\t13.01\n4550002\tNong Chok/Khlong Sip Song\tMarch\t3\t2014\t12.41\n4550003\tLak Si/Thung Song Hong\tMarch\t3\t2014\t2.6799999999999997\n4550018\tSaphan Sung/Saphan Sung\tFebruary\t2\t2014\t17.349999999999998\n4550009\tNong Chok/Khok Faet\tApril\t4\t2014\t9.77\n4550003\tLak Si/Thung Song Hong\tMay\t5\t2014\t108.66\n4550018\tSaphan Sung/Saphan Sung\tMarch\t3\t2014\t21.35\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t2\t2014\t15.44\n4550015\tPhaya Thai/Sam Sen Nai\tMay\t5\t2014\t53.0\n4550025\tBang Khun Thian/Samae Dam\tFebruary\t2\t2014\t18.759999999999998\n4550007\tNong Chok/Khu Fang Nuea\tJanuary\t1\t2014\t0.99\n4550008\tBang Khen/Tha Raeng\tMarch\t3\t2014\t6.09\n4550008\tBang Khen/Tha Raeng\tMay\t5\t2014\t73.58000000000001\n4550002\tNong Chok/Khlong Sip Song\tJanuary\t1\t2014\t10.64\n4550013\tNong Chok/Lam Phak Chi\tApril\t4\t2014\t14.37\n4550003\tLak Si/Thung Song Hong\tJanuary\t1\t2014\t0.0\n4550024\tBang Bon/Bang Bon\tMay\t5\t2014\t95.72999999999999\n4550002\tNong Chok/Khlong Sip Song\tFebruary\t2\t2014\t16.79\n4550027\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t11.3\n4550010\tLat Phrao/Lat Phrao\tApril\t4\t2014\t12.929999999999998\n4550020\tLat Krabang/Khum Thong\tMarch\t3\t2014\t4.08\n4550020\tLat Krabang/Khum Thong\tJanuary\t1\t2014\t12.3\n4550011\tBueng Kum/Khlong Kum\tApril\t4\t2014\t0.0\n4550028\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t125.76\n4550004\tBang Khen/Tha Raeng\tApril\t4\t2014\t7.6\n4550018\tSaphan Sung/Saphan Sung\tJanuary\t1\t2014\t21.86\n4550010\tLat Phrao/Lat Phrao\tMarch\t3\t2014\t5.359999999999999\n4550007\tNong Chok/Khu Fang Nuea\tMarch\t3\t2014\t50.92999999999999\n4550010\tLat Phrao/Lat Phrao\tJanuary\t1\t2014\t6.890000000000001\n4550027\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t8.2\n4550012\tMin Buri/Saen Saep\tMay\t5\t2014\t33.45\n4550028\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t0.2\n4550002\tNong Chok/Khlong Sip Song\tMay\t5\t2014\t35.91\n4550025\tBang Khun Thian/Samae Dam\tApril\t4\t2014\t21.430000000000003\n4550026\tBang Khun Thian/Tha Kham\tFebruary\t2\t2014\t16.220000000000002\n4550027\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t5.0\n4550016\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t9.13\n4550021\tBang Khae/Bang Phai\tJanuary\t1\t2014\t10.29\n4550022\tPrawet/Nong Bon\tJanuary\t1\t2014\t1.49\n4550004\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t0.0\n4550009\tNong Chok/Khok Faet\tMarch\t3\t2014\t11.389999999999999\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t1\t2014\t1.25\n4550001\tDon Mueang/Sanam Bin\tFebruary\t2\t2014\t0.0\n4550010\tLat Phrao/Lat Phrao\tMay\t5\t2014\t40.739999999999995\n4550017\tHuai Khwang/Bang Kapi\tMarch\t3\t2014\t28.910000000000004\n4550028\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t38.980000000000004\n4550020\tLat Krabang/Khum Thong\tMay\t5\t2014\t59.660000000000004\n4550012\tMin Buri/Saen Saep\tMarch\t3\t2014\t7.08\n4550019\tLat Krabang/Khlong Sam Prawet\tMay\t5\t2014\t0.0\n4550022\tPrawet/Nong Bon\tFebruary\t2\t2014\t20.0\n4550017\tHuai Khwang/Bang Kapi\tFebruary\t2\t2014\t20.73\n4550009\tNong Chok/Khok Faet\tFebruary\t2\t2014\t16.52\n4550024\tBang Bon/Bang Bon\tMarch\t3\t2014\t11.5\n4550023\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t22.84\n4550027\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\n4550024\tBang Bon/Bang Bon\tFebruary\t2\t2014\t36.190000000000005\n4550027\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\n4550021\tBang Khae/Bang Phai\tMay\t5\t2014\t73.0\n4550014\tNong Chok/Krathum Rai\tApril\t4\t2014\t12.76\n4550009\tNong Chok/Khok Faet\tMay\t5\t2014\t0.83\n4550022\tPrawet/Nong Bon\tMarch\t3\t2014\t15.280000000000001\n4550023\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t2.15\n4550028\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t63.43\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t2\t2014\t15.720000000000002\n4550026\tBang Khun Thian/Tha Kham\tMay\t5\t2014\t91.07\n4550028\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.4\n4550014\tNong Chok/Krathum Rai\tMarch\t3\t2014\t2.25\n4550022\tPrawet/Nong Bon\tApril\t4\t2014\t14.629999999999997\n4550028\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\n4550025\tBang Khun Thian/Samae Dam\tMay\t5\t2014\t96.8\n4550017\tHuai Khwang/Bang Kapi\tApril\t4\t2014\t6.710000000000001\n4550016\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t3.13\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t1\t2014\t23.880000000000003\n4550013\tNong Chok/Lam Phak Chi\tFebruary\t2\t2014\t18.560000000000002\n4550001\tDon Mueang/Sanam Bin\tJanuary\t1\t2014\t0.0\n4550015\tPhaya Thai/Sam Sen Nai\tApril\t4\t2014\t7.359999999999999\n4550027\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t18.599999999999998\n4550026\tBang Khun Thian/Tha Kham\tJanuary\t1\t2014\t24.099999999999998\n4550013\tNong Chok/Lam Phak Chi\tJanuary\t1\t2014\t8.690000000000001\n4550012\tMin Buri/Saen Saep\tFebruary\t2\t2014\t20.33\n4550028\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\n4550013\tNong Chok/Lam Phak Chi\tMay\t5\t2014\t0.0\n4550007\tNong Chok/Khu Fang Nuea\tMay\t5\t2014\t84.03\n4550011\tBueng Kum/Khlong Kum\tFebruary\t2\t2014\t11.6\n4550016\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t11.23\n4550023\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t5.87\n4550014\tNong Chok/Krathum Rai\tFebruary\t2\t2014\t3.2800000000000002\n4550027\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t47.699999999999996\n4550001\tDon Mueang/Sanam Bin\tApril\t4\t2014\t9.47\n4550023\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t90.91999999999999\n4550009\tNong Chok/Khok Faet\tJanuary\t1\t2014\t0.8600000000000001\n4550003\tLak Si/Thung Song Hong\tApril\t4\t2014\t1.91\n4550021\tBang Khae/Bang Phai\tMarch\t3\t2014\t12.530000000000001\n4550014\tNong Chok/Krathum Rai\tMay\t5\t2014\t107.71000000000001\n4550012\tMin Buri/Saen Saep\tApril\t4\t2014\t21.720000000000002\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t4\t2014\t5.64\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t5\t2014\t91.25\n4550025\tBang Khun Thian/Samae Dam\tMarch\t3\t2014\t23.66\n4550004\tBang Khen/Tha Raeng\tMarch\t3\t2014\t20.86\n"},{"type":"TEXT","data":"\n"}]}},{"title":"4.2) Reduce - Find average of water-level dataset from 9 stations and union them all to one finally dataset.","text":"%pyspark\ndef reduceCleanWaterLevelData(waterlvDF):\n    return waterlvDF.filter(waterlvDF['Year']==\"2014\").groupBy([\"Station\"]).pivot(\"Month\").mean(\"WaterLavel\")\n\nwaterLevelBKK001SummaryDF = reduceCleanWaterLevelData(waterLevelBKK001CleanDF)\nwaterLevelBKK003SummaryDF = reduceCleanWaterLevelData(waterLevelBKK003CleanDF)\nwaterLevelBKK004SummaryDF = reduceCleanWaterLevelData(waterLevelBKK004CleanDF)\nwaterLevelBKK005SummaryDF = reduceCleanWaterLevelData(waterLevelBKK005CleanDF)\nwaterLevelBKK008SummaryDF = reduceCleanWaterLevelData(waterLevelBKK008CleanDF)\nwaterLevelBKK009SummaryDF = reduceCleanWaterLevelData(waterLevelBKK009CleanDF)\nwaterLevelBKK020SummaryDF = reduceCleanWaterLevelData(waterLevelBKK020CleanDF)\nwaterLevelBKK021SummaryDF = reduceCleanWaterLevelData(waterLevelBKK021CleanDF)\nwaterLevelCPY015SummaryDF = reduceCleanWaterLevelData(waterLevelCPY015CleanDF)\n\nwaterLevelFinalDF = waterLevelBKK001SummaryDF.union(waterLevelBKK003SummaryDF).union(waterLevelBKK004SummaryDF).union(waterLevelBKK005SummaryDF).union(waterLevelBKK008SummaryDF).union(waterLevelBKK009SummaryDF).union(waterLevelBKK020SummaryDF).union(waterLevelBKK021SummaryDF).union(waterLevelCPY015SummaryDF)\nz.show(waterLevelFinalDF)","user":"anonymous","dateUpdated":"2020-11-07T07:44:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"1":"string","2":"string","3":"string","4":"string","5":"string","6":"string","7":"string","8":"string","9":"string","10":"string","11":"string","12":"string","Station":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"Station","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"1","index":1,"aggr":"avg"},{"name":"2","index":2,"aggr":"avg"},{"name":"3","index":3,"aggr":"avg"},{"name":"4","index":4,"aggr":"avg"},{"name":"5","index":5,"aggr":"avg"},{"name":"6","index":6,"aggr":"avg"},{"name":"7","index":7,"aggr":"avg"},{"name":"8","index":8,"aggr":"avg"},{"name":"9","index":9,"aggr":"avg"},{"name":"10","index":10,"aggr":"avg"},{"name":"11","index":11,"aggr":"avg"},{"name":"12","index":12,"aggr":"avg"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=572","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=573","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=574","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=575","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=576","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=577","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=578","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=579","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=580","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=581","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=582","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=583","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=584","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=585","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=586"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604121812257_1412141453","id":"20201031-052332_1465106584","dateCreated":"2020-10-31T05:23:32+0000","dateStarted":"2020-11-07T07:40:07+0000","dateFinished":"2020-11-07T07:44:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9171","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Station\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\nBKK001\t-0.033736559139785224\t-0.09489087301587266\t-0.06718189964157614\t-0.12100231481481337\t-0.1000560035842293\t-4.8611111111091827E-4\t0.07310483870967739\t0.2859005376344111\t0.49686342592591376\t0.46486783154121986\t0.07017824074074075\t0.08315188172043125\nBKK003\t0.7388037634408569\t0.7790749007936503\t0.8023745519713245\t0.6482222222222206\t0.5563821684587792\t0.39351157407407356\t0.3970855734767018\t0.46962813620071625\t0.6223101851851877\t0.6377732974910395\t0.7570879629629607\t0.4248835125448032\nBKK004\t0.5165412186379946\t0.5463070436507858\t0.5184923835125449\t0.4258680555555585\t0.3643862007168473\t0.23389120370370334\t0.0\t0.0\t0.0845694444444443\t0.6328785842293879\t0.7187546296296261\t0.5261738351254444\nBKK005\t0.25579749103942695\t0.2699975198412655\t0.254348118279568\t0.1880324074074083\t0.1551164874551973\t0.08342824074074058\t0.1159520609319\t0.1865591397849463\t0.23516203703703834\t0.3729614695340513\t0.3796574074074099\t0.2633534946236567\nBKK008\t0.05332213261648791\t0.02528025793650788\t0.004292114695340425\t-0.0976597222222221\t-0.17682347670251128\t-0.1258819444444445\t-0.12943324372759896\t-0.13806675627240164\t-0.21286805555555552\t-0.19073924731182917\t0.003629629629629544\t0.09369399641577128\nBKK009\t-0.39977374551971573\t-1.0581324404761863\t-0.7251344086021593\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0034791666666666703\t0.025757168458781527\t-0.0948240740740743\t-0.2865681003584185\nBKK020\t0.16056899641576852\t0.060473710317460946\t-0.05504256272401432\t-0.12927083333333156\t-0.08975134408602249\t0.12279629629629632\t0.2741218637992861\t0.7086469534050276\t1.0293634259259308\t0.9909094982078753\t0.7988217592592557\t0.32075716845877805\nBKK021\t1.0358602150537586\t0.9739360119047913\t0.9634744623655737\t0.8536180555555447\t0.8670743727598739\t0.910099537037004\t0.9367047491039292\t1.1518436379928396\t1.2116875000000127\t1.253073476702483\t1.2898981481481453\t1.1348476702509072\nCPY015\t0.45088037634408484\t0.4648685515873004\t0.4668525985663073\t0.32065972222222233\t0.24951612903225773\t0.15922222222222238\t0.13917786738351226\t0.22361111111111137\t0.3845185185185183\t0.44271057347670173\t0.3295949074074083\t0.4974843189964155\n"},{"type":"TEXT","data":"\n"}]}},{"title":"4.3) Reduce - 2 Sources integration. Rainy rate data & Water-level data","text":"%pyspark\nstationDF = spark.createDataFrame(\n    [\n        (\"BKK001\", [\"4550004\", \"4550005\", \"4550006\", \"4550020\"]),\n        (\"BKK004\", [\"4550007\"]),\n        (\"BKK005\", [\"4550021\", \"4550024\", \"4550025\", \"4550026\"]),\n        (\"BKK008\", [\"4550003\", \"4550017\", \"4550018\", \"4550022\", \"4550027\"]),\n        (\"BKK009\", [\"4550002\", \"4550009\", \"4550012\", \"4550013\", \"4550014\", \"4550016\", \"4550019\", \"4550023\"]),\n        (\"BKK021\", [\"4550001\", \"4550008\", \"4550010\", \"4550011\"]),\n        (\"CPY015\", [\"4550015\", \"4550028\"])\n    ],\n    [\"station\", \"areas\"]\n)\n\ndef getStation(areaCode):\n    result = \"NULL\"\n    for row in stationDF.rdd.collect():\n        areas = row[\"areas\"]\n        if areaCode in areas:\n            result = row[\"station\"]\n    return result\n\n\n\n\n\ngroupByMYDF.show(10)\n\n\n\n\n\nassert \"BKK001\" == getStation(\"4550004\")\nassert \"BKK021\" == getStation(\"4550008\")\nassert \"CPY015\" == getStation(\"4550028\")","user":"anonymous","dateUpdated":"2020-11-07T07:48:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=595","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=596","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=597","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=598","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=599","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=600","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=601"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604733693112_385354186","id":"20201107-072133_1583704739","dateCreated":"2020-11-07T07:21:33+0000","dateStarted":"2020-11-07T07:48:27+0000","dateFinished":"2020-11-07T07:48:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9172","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------------+---------+-------+----+------------------+\n|StationId|            Location|MonthName|MonthNo|Year| sum(DayRainyRate)|\n+---------+--------------------+---------+-------+----+------------------+\n|  4550019|Lat Krabang/Khlon...| February|      2|2014|22.789999999999996|\n|  4550025|Bang Khun Thian/S...|  January|      1|2014|             30.98|\n|  4550018|Saphan Sung/Sapha...|      May|      5|2014|             40.63|\n|  4550004| Bang Khen/Tha Raeng|      May|      5|2014|            114.27|\n|  4550016|Lat Krabang/Lam P...|    March|      3|2014|18.509999999999998|\n|  4550004| Bang Khen/Tha Raeng|  January|      1|2014|               0.0|\n|  4550026|Bang Khun Thian/T...|    March|      3|2014|              5.92|\n|  4550026|Bang Khun Thian/T...|    April|      4|2014|              4.58|\n|  4550027|Khlong Toei/Khlon...|     July|      7|2014|              38.4|\n|  4550014|Nong Chok/Krathum...|  January|      1|2014|15.510000000000002|\n+---------+--------------------+---------+-------+----+------------------+\nonly showing top 10 rows\n\n"}]}},{"title":"5.1) Outlier Detection - Rainy Rate","text":"%pyspark\nimport pyspark.sql.functions as F\nfrom pyspark.sql.types import StringType\n\nsummaryDF = groupByMYDF.select(\"sum(DayRainyRate)\").summary(\"min\", \"max\", \"25%\", \"75%\", \"mean\", \"stddev\")\nmin = float(summaryDF.collect()[0][1])\nmax = float(summaryDF.collect()[1][1])\nq1 = float(summaryDF.collect()[2][1])\nq3 = float(summaryDF.collect()[3][1])\nmean = float(summaryDF.collect()[4][1])\nsd = float(summaryDF.collect()[5][1])\nsummaryDF.show()\n\niqr = q3-q1\nupperB = q3+(1.5*iqr)\nlowerB = q1-(1.5*iqr)\nprint \"IQR: {}\".format(iqr)\nprint \"Upper Bound: {} / Lower Bound: {}\".format(upperB, lowerB)\n\ndef checkBoundary(sumRate):\n    if sumRate > upperB: \n        return 'upper bound'\n    elif sumRate < lowerB:\n        return 'lower bound'\n    else :\n        return 'normal'\n\ncheckBoundaryFunc = F.udf(checkBoundary, StringType())\n\nOutlierDF = groupByMYDF.withColumn(\"Outlier\", checkBoundaryFunc(\"sum(DayRainyRate)\"))\nz.show(OutlierDF)","user":"anonymous","dateUpdated":"2020-11-07T06:08:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Average_SummaryDayRainyRate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""},{"name":"MonthName","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthNo","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"sum(DayRainyRate)","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Outlier","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","MonthName":"string","MonthNo":"string","Year":"string","sum(DayRainyRate)":"string","Outlier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Location","index":0,"aggr":"sum"},"yAxis":{"name":"Outlier","index":5,"aggr":"sum"},"group":{"name":"MonthName","index":1,"aggr":"sum"}},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate"}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"MonthName","index":1,"aggr":"sum"}],"values":[{"name":"Outlier","index":5,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=433","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=434","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=435","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=436","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=437","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=438","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=439","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=440"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603634178174_-1976633791","id":"20201025-135618_251945645","dateCreated":"2020-10-25T13:56:18+0000","dateStarted":"2020-11-07T06:08:27+0000","dateFinished":"2020-11-07T06:08:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9173"},{"title":"5.2) Outlier Detection - Water level","text":"%pyspark\nfrom pyspark.sql.functions import col\n\ninYearDF = waterLevelFinalDF.select(\"Station\" ,(((col(\"1\")+col(\"2\")+col(\"3\")+col(\"4\")+col(\"5\")+col(\"6\")+col(\"7\")+col(\"8\")+col(\"9\")+col(\"10\")+col(\"11\")+col(\"12\"))/12)).alias(\"inYearAverage\"))\ninYearStatisticDF=inYearDF.select(\"inYearAverage\").summary(\"min\", \"max\", \"25%\", \"75%\", \"mean\", \"stddev\")\nminInYear = float(inYearStatisticDF.collect()[0][1])\nmaxInYear = float(inYearStatisticDF.collect()[1][1])\nq1InYear = float(inYearStatisticDF.collect()[2][1])\nq3InYear = float(inYearStatisticDF.collect()[3][1])\nmeanInYear = float(inYearStatisticDF.collect()[4][1])\nsdInYear = float(inYearStatisticDF.collect()[5][1])\ninYearStatisticDF.show()\n\niqrInYear = q3InYear-q1InYear\nupperBInYear = q3InYear+(1.5*iqrInYear)\nlowerBInYear = q1InYear-(1.5*iqrInYear)\nprint \"IQR: {}\".format(iqrInYear)\nprint \"Upper Bound: {} / Lower Bound: {}\".format(upperBInYear, lowerBInYear)\n\ndef checkBoundaryInYear(inYear):\n    if inYear > upperB: \n        return 'upper bound'\n    elif inYear < lowerB:\n        return 'lower bound'\n    else :\n        return 'normal'\n\ncheckBoundaryFunc = F.udf(checkBoundaryInYear, StringType())\noutlierInYearDF = inYearDF.withColumn(\"Outlier\", checkBoundaryFunc(\"inYearAverage\"))\noutlierInYearDF.show()","user":"anonymous","dateUpdated":"2020-11-07T07:11:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"1":"string","2":"string","3":"string","4":"string","5":"string","6":"string","7":"string","8":"string","9":"string","10":"string","11":"string","12":"string","Station":"string","allMonths":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Station":"string","inYear":"string","Outlier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=482","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=483","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=484","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=485","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=486","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=487","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=488"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1604728848785_2142310530","id":"20201107-060048_938301864","dateCreated":"2020-11-07T06:00:48+0000","dateStarted":"2020-11-07T07:11:51+0000","dateFinished":"2020-11-07T07:15:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:9174"}],"name":"flooding_project","id":"2FQA9YR6K","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
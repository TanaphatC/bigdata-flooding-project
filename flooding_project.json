{"paragraphs":[{"text":"%sh\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data\"; then\n    hdfs dfs -mkdir -p /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/rainfall_hourly_data2.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/rainfall_hourly_data2.csv\n    hdfs dfs -put rainfall_hourly_data2.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK001.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK001.csv\n    hdfs dfs -put water_level_station_BKK001.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK003.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK003.csv\n    hdfs dfs -put water_level_station_BKK003.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK004.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK004.csv\n    hdfs dfs -put water_level_station_BKK004.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK005.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK005.csv\n    hdfs dfs -put water_level_station_BKK005.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK008.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK008.csv\n    hdfs dfs -put water_level_station_BKK008.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK009.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK009.csv\n    hdfs dfs -put water_level_station_BKK009.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK020.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK020.csv\n    hdfs dfs -put water_level_station_BKK020.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_BKK021.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK021.csv\n    hdfs dfs -put water_level_station_BKK021.csv /user/zeppelin/flooding_data\nfi\n\nif ! hdfs dfs -test -e \"/user/zeppelin/flooding_data/water_level_station_CPY015.csv\"; then\n    wget  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_CPY015.csv\n    hdfs dfs -put water_level_station_CPY015.csv /user/zeppelin/flooding_data\nfi","user":"anonymous","dateUpdated":"2020-11-15T04:11:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1605412312194_1982661551","id":"20201115-035152_1390470029","dateCreated":"2020-11-15T03:51:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4645","dateFinished":"2020-11-15T04:05:39+0000","dateStarted":"2020-11-15T04:04:41+0000","title":"0) Prerequisite - Download datasets from Github","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2020-11-15 04:04:48--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/rainfall_hourly_data2.csv\nResolving github.com (github.com)... 140.82.112.3\nConnecting to github.com (github.com)|140.82.112.3|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘rainfall_hourly_data2.csv.3’\n\n     0K .......... .......... .......... .......... ..........  964K\n    50K .......... .......... .......... ..........            78.9M=0.05s\n\n2020-11-15 04:04:49 (1.68 MB/s) - ‘rainfall_hourly_data2.csv.3’ saved [92186]\n\n--2020-11-15 04:04:54--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK001.csv\nResolving github.com (github.com)... 140.82.113.4\nConnecting to github.com (github.com)|140.82.113.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK001.csv’\n\n     0K .......... .......... .......... .......... ..........  966K\n    50K .......... .......... .......... ..........            75.7M=0.05s\n\n2020-11-15 04:04:55 (1.68 MB/s) - ‘water_level_station_BKK001.csv’ saved [92286]\n\n--2020-11-15 04:05:00--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK003.csv\nResolving github.com (github.com)... 140.82.114.4\nConnecting to github.com (github.com)|140.82.114.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK003.csv’\n\n     0K .......... .......... .......... .......... ..........  973K\n    50K .......... .......... .......... ..........            56.0M=0.05s\n\n2020-11-15 04:05:00 (1.69 MB/s) - ‘water_level_station_BKK003.csv’ saved [92286]\n\n--2020-11-15 04:05:05--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK004.csv\nResolving github.com (github.com)... 140.82.112.4\nConnecting to github.com (github.com)|140.82.112.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK004.csv’\n\n     0K .......... .......... .......... .......... .......... 1000K\n    50K .......... .......... .......... ..........            1.60M=0.07s\n\n2020-11-15 04:05:05 (1.18 MB/s) - ‘water_level_station_BKK004.csv’ saved [92277]\n\n--2020-11-15 04:05:10--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK005.csv\nResolving github.com (github.com)... 140.82.112.3\nConnecting to github.com (github.com)|140.82.112.3|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK005.csv’\n\n     0K .......... .......... .......... .......... ..........  956K\n    50K .......... .......... .......... ..........            62.6M=0.05s\n\n2020-11-15 04:05:11 (1.66 MB/s) - ‘water_level_station_BKK005.csv’ saved [92282]\n\n--2020-11-15 04:05:15--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK008.csv\nResolving github.com (github.com)... 140.82.112.3\nConnecting to github.com (github.com)|140.82.112.3|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK008.csv’\n\n     0K .......... .......... .......... .......... ..........  989K\n    50K .......... .......... .......... ..........            61.4M=0.05s\n\n2020-11-15 04:05:16 (1.72 MB/s) - ‘water_level_station_BKK008.csv’ saved [92286]\n\n--2020-11-15 04:05:21--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK009.csv\nResolving github.com (github.com)... 140.82.112.3\nConnecting to github.com (github.com)|140.82.112.3|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK009.csv’\n\n     0K .......... .......... .......... .......... ..........  979K\n    50K .......... .......... .......... ..........            1.59M=0.08s\n\n2020-11-15 04:05:21 (1.16 MB/s) - ‘water_level_station_BKK009.csv’ saved [92276]\n\n--2020-11-15 04:05:26--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK020.csv\nResolving github.com (github.com)... 140.82.112.4\nConnecting to github.com (github.com)|140.82.112.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK020.csv’\n\n     0K .......... .......... .......... .......... ..........  963K\n    50K .......... .......... .......... ..........            1.65M=0.08s\n\n2020-11-15 04:05:26 (1.16 MB/s) - ‘water_level_station_BKK020.csv’ saved [92280]\n\n--2020-11-15 04:05:31--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_BKK021.csv\nResolving github.com (github.com)... 140.82.114.4\nConnecting to github.com (github.com)|140.82.114.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_BKK021.csv’\n\n     0K .......... .......... .......... .......... ..........  983K\n    50K .......... .......... .......... ..........            1.62M=0.08s\n\n2020-11-15 04:05:32 (1.17 MB/s) - ‘water_level_station_BKK021.csv’ saved [92286]\n\n--2020-11-15 04:05:37--  https://github.com/TanaphatC/bigdata-flooding-project/blob/master/water_level_station_CPY015.csv\nResolving github.com (github.com)... 140.82.112.4\nConnecting to github.com (github.com)|140.82.112.4|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: ‘water_level_station_CPY015.csv’\n\n     0K .......... .......... .......... .......... ..........  972K\n    50K .......... .......... .......... ..........            1.62M=0.08s\n\n2020-11-15 04:05:37 (1.16 MB/s) - ‘water_level_station_CPY015.csv’ saved [92280]\n\n"}]}},{"title":"1.1) Hourly rainfall rate dataset importing from HUE","text":"%pyspark\r\nhourlyData = spark.read.csv(\"/user/zeppelin/flooding_data/rainfall_hourly_data2.csv\", header=True, inferSchema=True)","user":"anonymous","dateUpdated":"2020-11-15T04:10:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1602925411281_1573475665","id":"20201017-090331_940034940","dateCreated":"2020-10-17T09:03:31+0000","dateStarted":"2020-11-15T04:10:46+0000","dateFinished":"2020-11-15T04:10:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:377","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=0","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"title":"1.2) Hourly water level rate dataset importing from HUE","text":"%pyspark\nfrom pyspark.sql.functions import lit\n\nwaterLevelBKK001DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK001.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK001\"))\nwaterLevelBKK003DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK003.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK003\"))\nwaterLevelBKK004DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK004.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK004\"))\nwaterLevelBKK005DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK005.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK005\"))\nwaterLevelBKK008DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK008.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK008\"))\nwaterLevelBKK009DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK009.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK009\"))\nwaterLevelBKK020DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK020.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK020\"))\nwaterLevelBKK021DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_BKK021.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"BKK021\"))\nwaterLevelCPY015DF = spark.read.csv(\"/user/zeppelin/flooding_data/water_level_station_CPY015.csv\", header=True, inferSchema=True).withColumn(\"station\", lit(\"CPY015\"))","user":"anonymous","dateUpdated":"2020-11-15T04:11:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604220295277_774090316","id":"20201101-084455_903609208","dateCreated":"2020-11-01T08:44:55+0000","dateStarted":"2020-11-15T04:11:42+0000","dateFinished":"2020-11-15T04:11:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:378","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=2","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=3","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=4","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=5","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=6","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=7","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=8","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=9","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=10","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=11","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=12","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=13","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=14","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=15","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=16","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=17","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=18","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}}},{"title":"2.1) Data Preprocessing - Filter only Bangkok","text":"%pyspark\n#filter only \"Bangkok\" province and assign to valiable 'bangkokHourlyData'\nbangkokHourlyData = hourlyData.filter(hourlyData['province_name_en']==\"Bangkok\").select(hourlyData['station_id'], hourlyData['province_name_en'], hourlyData['district'], hourlyData['sub_district'], hourlyData['date'],  hourlyData['H01'], hourlyData['H02'], hourlyData['H03'], hourlyData['H04'], hourlyData['H05'], hourlyData['H06'], hourlyData['H07'], hourlyData['H08'], hourlyData['H09'], hourlyData['H10'], hourlyData['H11'], hourlyData['H12'], hourlyData['H13'], hourlyData['H14'], hourlyData['H15'], hourlyData['H16'], hourlyData['H17'], hourlyData['H18'], hourlyData['H19'], hourlyData['H20'], hourlyData['H21'], hourlyData['H22'], hourlyData['H23'], hourlyData['H24'])\n","user":"anonymous","dateUpdated":"2020-11-14T04:27:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"province_name_en","visible":true,"width":"*","sort":{"direction":"asc","priority":0},"filters":[{}],"pinned":""},{"name":"district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"sub_district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H01","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H02","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H03","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H04","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H05","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H06","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H07","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H08","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H09","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H10","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H11","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H12","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H13","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H14","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H15","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H16","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H17","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H18","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H19","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H20","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H21","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H22","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H23","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H24","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[{"field":"province_name_en","groupPriority":0,"colName":"province_name_en"}],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1602925420895_-1295208824","id":"20201017-090340_1507830950","dateCreated":"2020-10-17T09:03:40+0000","dateStarted":"2020-11-08T13:29:48+0000","dateFinished":"2020-11-08T13:29:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"title":"2.2) Missing Value (Statistical value of known data): calculate average rainy rate of each that day","text":"%pyspark\n#calculate the number of rainy hours on that day. (rainy hour = 24 - dry hour)\nimport datetime\n\nrainyHourArray = []\n\nclass RainyHour:\n    \n    def __init__(self, district, subDistrict, date, totalRainyHour, summaryRainyRate):\n        self.key = str(abs(hash(district+subDistrict)))\n        self.location = str(district + \"/\" + subDistrict)\n        self.day = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n        self.month = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n        self.year = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n        self.totalRainyHour = totalRainyHour\n        self.summaryRainyRate = summaryRainyRate\n        self.averageRainyRate = self.calAvg()\n    \n    def info(self):\n        return (self.key, self.location, self.day, self.month, self.year, self.totalRainyHour, self.summaryRainyRate, self.averageRainyRate)\n    \n    def calAvg(self):\n        if self.totalRainyHour!=0 and self.summaryRainyRate>0.0: \n            return round(self.summaryRainyRate / self.totalRainyHour, 2)\n        else:\n            return 0\n\ndef calculateRainyHour(row):\n    rainyHour=24\n    summaryRainyRate = 0.0\n    \n    for i in range(1, 25):\n        colName= \"H0\"+str(i) if i<=9 else \"H\"+str(i)\n        \n        if row[colName]!=\"NULL\" and float(row[colName])==0.0:\n            rainyHour-=1\n\n        if row[colName]!=\"NULL\" : summaryRainyRate+=float(row[colName])\n            \n    return RainyHour(row['district'], row['sub_district'], row['date'], rainyHour, summaryRainyRate)\n\n\nfor row in bangkokHourlyData.rdd.collect():\n    r = calculateRainyHour(row)\n    rainyHourArray.append(r.info())\n\ndef getAvgRainyRateByLocationAndDate(district, subDistrict, date):\n    row = 0.0\n    keyIn = str(abs(hash(district+subDistrict)))\n    dayIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n    monthIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n    yearIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n    \n    for r in rainyHourArray:\n        if r[0]==keyIn and r[2]==dayIn and r[3]==monthIn and r[4]==yearIn:\n            row =  r[7]\n    \n    return row\n    ","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"yAxis":{"name":"NumberOfRainyHour","index":3,"aggr":"sum"},"size":{"name":"Location","index":1,"aggr":"sum"},"xAxis":{"name":"Location","index":1,"aggr":"sum"}},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603029858134_-1147608560","id":"20201018-140418_1176902503","dateCreated":"2020-10-18T14:04:18+0000","dateStarted":"2020-11-08T13:29:48+0000","dateFinished":"2020-11-08T13:29:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"title":"2.3) Missing value (Statistical value of known data) - Replace NULL with average rainy rate of each that day","text":"%pyspark\ndef replaceNullWithAvg(row):\n    avgRainyRate = getAvgRainyRateByLocationAndDate(row['district'], row['sub_district'], row['date'])\n    return (\n        float(avgRainyRate if row['H01']==\"NULL\" else row['H01']),\n        float(avgRainyRate if row['H02']==\"NULL\" else row['H02']),\n        float(avgRainyRate if row['H03']==\"NULL\" else row['H03']),\n        float(avgRainyRate if row['H04']==\"NULL\" else row['H04']),\n        float(avgRainyRate if row['H05']==\"NULL\" else row['H05']),\n        float(avgRainyRate if row['H06']==\"NULL\" else row['H06']),\n        float(avgRainyRate if row['H07']==\"NULL\" else row['H07']),\n        float(avgRainyRate if row['H08']==\"NULL\" else row['H08']),\n        float(avgRainyRate if row['H09']==\"NULL\" else row['H09']),\n        float(avgRainyRate if row['H10']==\"NULL\" else row['H10']),\n        float(avgRainyRate if row['H11']==\"NULL\" else row['H11']),\n        float(avgRainyRate if row['H12']==\"NULL\" else row['H12']),\n        float(avgRainyRate if row['H13']==\"NULL\" else row['H13']),\n        float(avgRainyRate if row['H14']==\"NULL\" else row['H14']),\n        float(avgRainyRate if row['H15']==\"NULL\" else row['H15']),\n        float(avgRainyRate if row['H16']==\"NULL\" else row['H16']),\n        float(avgRainyRate if row['H17']==\"NULL\" else row['H17']),\n        float(avgRainyRate if row['H18']==\"NULL\" else row['H18']),\n        float(avgRainyRate if row['H19']==\"NULL\" else row['H19']),\n        float(avgRainyRate if row['H20']==\"NULL\" else row['H20']),\n        float(avgRainyRate if row['H21']==\"NULL\" else row['H21']),\n        float(avgRainyRate if row['H22']==\"NULL\" else row['H22']),\n        float(avgRainyRate if row['H23']==\"NULL\" else row['H23']),\n        float(avgRainyRate if row['H24']==\"NULL\" else row['H24'])\n    )\n\ndef extract(row):\n    rowDate = row['date']\n    day = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().day)\n    month = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().month)\n    year = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().year)\n    \n    return (\n        row['station_id'], row['district'] + \"/\" + row['sub_district'], day, month, year, replaceNullWithAvg(row)\n    )\n\n\ncleanDF=bangkokHourlyData.rdd.map(extract).toDF(['StationId', 'Location','Day','Month', 'Year', 'RainyRates'])\n","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Day","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Month","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"RainyHours","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyHours":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"scatterChart":{"xAxis":{"name":"Location","index":0,"aggr":"sum"}}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"Month","index":2,"aggr":"sum"}],"values":[{"name":"RainyHours","index":4,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603523563777_1375166502","id":"20201024-071243_435153083","dateCreated":"2020-10-24T07:12:43+0000","dateStarted":"2020-11-08T13:29:51+0000","dateFinished":"2020-11-08T13:29:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"title":"2.4) Missing value - Check rainy rate since 01:00 till 24:00 should not be NULL","text":"%pyspark\nfor row in cleanDF.rdd.collect():\n    hourRow = row['RainyRates']\n    for i in range(0, 23):\n        assert \"True\" == str((hourRow[i] != \"NULL\"))","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1603611944566_-1555939565","id":"20201025-074544_914445690","dateCreated":"2020-10-25T07:45:44+0000","dateStarted":"2020-11-08T13:29:53+0000","dateFinished":"2020-11-08T13:29:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"title":"2.5) Preprocessing - Extract calendar column to day, month, year column on water-level dataset","text":"%pyspark\nimport datetime\nfrom pyspark.sql import Row\n\nmonthsArray = [\"none\", \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\ndef extract(row):\n    rowDate = str(row['date'])[:10]\n    day = str(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().day)\n    month = int(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().month)\n    year = str(datetime.datetime.strptime(rowDate, \"%Y-%m-%d\").date().year)\n    \n    return (\n        row['station'], day, month, monthsArray[(month)], year, row['time'], float(row['water_lv'])\n    )\n   \nwaterLevelBKK001ExtractDF = waterLevelBKK001DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK003ExtractDF = waterLevelBKK003DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK004ExtractDF = waterLevelBKK004DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK005ExtractDF = waterLevelBKK005DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK008ExtractDF = waterLevelBKK008DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK009ExtractDF = waterLevelBKK009DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK020ExtractDF = waterLevelBKK020DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelBKK021ExtractDF = waterLevelBKK021DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])\nwaterLevelCPY015ExtractDF = waterLevelCPY015DF.rdd.map(extract).toDF(['Station', 'Day','Month', 'MonthName','Year', 'Time', 'WaterLavel'])","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604223467973_563099537","id":"20201101-093747_766830479","dateCreated":"2020-11-01T09:37:47+0000","dateStarted":"2020-11-08T13:29:56+0000","dateFinished":"2020-11-08T13:29:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"title":"2.6) Cleansing Data - Replease abnormal value -999 of water-level","text":"%pyspark\nfrom pyspark.sql import Row\n\ndef replaseAbnormalWaterLevel(row):\n    waterLv = row['WaterLavel'] \n    if float(row['WaterLavel'])==float(-999):\n        waterLv = 0.0\n    return (\n        row['Station'], row['Day'], row['Month'] ,row['MonthName'], row['Year'], row['Time'], waterLv\n    )\n\nwaterLevelBKK001CleanDF = waterLevelBKK001ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station', 'Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK003CleanDF = waterLevelBKK003ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK004CleanDF = waterLevelBKK004ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK005CleanDF = waterLevelBKK005ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK008CleanDF = waterLevelBKK008ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK009CleanDF = waterLevelBKK009ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK020CleanDF = waterLevelBKK020ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelBKK021CleanDF = waterLevelBKK021ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\nwaterLevelCPY015CleanDF = waterLevelCPY015ExtractDF.rdd.map(replaseAbnormalWaterLevel).toDF(['Station','Day','Month', 'MonthName', 'Year', 'Time', 'WaterLavel'])\n","user":"anonymous","dateUpdated":"2020-11-14T04:30:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Day":"string","Month":"string","MonthName":"string","Year":"string","Time":"string","WaterLavel":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1604658398055_1755192589","id":"20201106-102638_1559502730","dateCreated":"2020-11-06T10:26:38+0000","dateStarted":"2020-11-08T13:29:58+0000","dateFinished":"2020-11-08T13:30:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"title":"3.1) Mapping - Finding summary and average rainy rate each that day","text":"%pyspark\nmonthsArray = [\"none\", \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\ndef summaryRainyRate(row):\n    summaryRate = 0.0\n    hourRow = row['RainyRates']\n    result = [ row['StationId'], row['Location'], row['Day'], str(row['Month']), monthsArray[int(row['Month'])], row['Year'], row['RainyRates'], ]\n    for i in range(0, 23):\n        summaryRate+=hourRow[i]\n    result.append(round(float(summaryRate), 2))\n    return result\n    \nsummaryDF = cleanDF.rdd.map(summaryRainyRate).toDF([\"StationId\", \"Location\",\"Day\", \"MonthNo\", \"MonthName\" ,\"Year\",\"RainyRate\", \"DayRainyRate\"]).sort('DayRainyRate', ascending=False)\nsummaryDF.show()\n","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyRate":"string","SummaryRainyRate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------------+---+-------+---------+----+--------------------+------------+\n|StationId|            Location|Day|MonthNo|MonthName|Year|           RainyRate|DayRainyRate|\n+---------+--------------------+---+-------+---------+----+--------------------+------------+\n|  4550006|Khlong Sam Wa/Sam...|  1|      5|      May|2014|[0.0, 0.0, 2.13, ...|      113.21|\n|  4550014|Nong Chok/Krathum...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       61.06|\n|  4550003|Lak Si/Thung Song...|  8|      5|      May|2014|[0.0, 4.54, 3.95,...|       58.82|\n|  4550004| Bang Khen/Tha Raeng|  8|      5|      May|2014|[0.0, 0.0, 4.4, 2...|       58.12|\n|  4550004| Bang Khen/Tha Raeng|  1|      5|      May|2014|[0.0, 0.0, 1.14, ...|       56.15|\n|  4550025|Bang Khun Thian/S...|  1|      5|      May|2014|[0.0, 0.0, 4.67, ...|       56.01|\n|  4550023|Lat Krabang/Lam P...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       55.55|\n|  4550007|Nong Chok/Khu Fan...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 3...|       53.81|\n|  4550024|   Bang Bon/Bang Bon|  8|      5|      May|2014|[3.34, 0.1, 0.72,...|       52.82|\n|  4550022|     Prawet/Nong Bon|  8|      5|      May|2014|[3.88, 2.26, 4.72...|       52.53|\n|  4550026|Bang Khun Thian/T...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 2...|       51.51|\n|  4550015|Phaya Thai/Sam Se...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 4...|       51.07|\n|  4550005|Khlong Sam Wa/Sam...|  8|      5|      May|2014|[0.0, 2.19, 0.61,...|        50.6|\n|  4550003|Lak Si/Thung Song...|  1|      5|      May|2014|[0.0, 0.0, 0.28, ...|       49.84|\n|  4550028|Khlong Toei/Khlon...| 28|      7|     July|2014|[0.0, 0.0, 0.0, 0...|        49.5|\n|  4550014|Nong Chok/Krathum...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 0...|       46.65|\n|  4550024|   Bang Bon/Bang Bon|  1|      5|      May|2014|[0.0, 0.0, 4.17, ...|       42.91|\n|  4550027|Khlong Toei/Khlon...| 22|      3|    March|2014|[0.0, 0.0, 0.0, 0...|        41.8|\n|  4550025|Bang Khun Thian/S...|  8|      5|      May|2014|[0.0, 0.0, 0.0, 0...|       40.79|\n|  4550005|Khlong Sam Wa/Sam...|  1|      5|      May|2014|[0.0, 0.0, 0.0, 1...|       40.65|\n+---------+--------------------+---+-------+---------+----+--------------------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1603622037681_330666540","id":"20201025-103357_826461112","dateCreated":"2020-10-25T10:33:57+0000","dateStarted":"2020-11-08T13:30:03+0000","dateFinished":"2020-11-08T13:30:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:385"},{"title":"4.1) Reduce - Summary rainy rate by month and year","text":"%pyspark\ngroupByMYDF = summaryDF.groupBy([\"StationId\", \"Location\", \"MonthName\", \"MonthNo\", \"Year\"]).sum(\"DayRainyRate\")\nz.show(groupByMYDF)\ngroupByMYDF.cache()","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":492,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"StationId":"string","Location":"string","MonthName":"string","MonthNo":"string","Year":"string","sum(DayRainyRate)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"yAxis":{"name":"sum(DayRainyRate)","index":5,"aggr":"sum"},"size":{"name":"sum(DayRainyRate)","index":5,"aggr":"sum"},"xAxis":{"name":"MonthNo","index":3,"aggr":"sum"},"group":{"name":"Location","index":1,"aggr":"sum"}},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","style":"stack"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","isDateFormat":false,"lineWithFocus":false,"forceY":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate","stacked":true},"pieChart":{}},"keys":[],"groups":[],"values":[],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":93,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"StationId\tLocation\tMonthName\tMonthNo\tYear\tsum(DayRainyRate)\n4550019\tLat Krabang/Khlong Sam Prawet\tFebruary\t2\t2014\t22.789999999999996\n4550025\tBang Khun Thian/Samae Dam\tJanuary\t1\t2014\t30.98\n4550004\tBang Khen/Tha Raeng\tMay\t5\t2014\t114.27\n4550018\tSaphan Sung/Saphan Sung\tMay\t5\t2014\t40.63\n4550016\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t18.509999999999998\n4550004\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t0.0\n4550026\tBang Khun Thian/Tha Kham\tMarch\t3\t2014\t5.92\n4550026\tBang Khun Thian/Tha Kham\tApril\t4\t2014\t4.58\n4550027\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t38.4\n4550014\tNong Chok/Krathum Rai\tJanuary\t1\t2014\t15.510000000000002\n4550001\tDon Mueang/Sanam Bin\tMarch\t3\t2014\t13.91\n4550018\tSaphan Sung/Saphan Sung\tApril\t4\t2014\t19.36\n4550024\tBang Bon/Bang Bon\tApril\t4\t2014\t8.02\n4550011\tBueng Kum/Khlong Kum\tJanuary\t1\t2014\t6.42\n4550011\tBueng Kum/Khlong Kum\tMay\t5\t2014\t18.6\n4550010\tLat Phrao/Lat Phrao\tFebruary\t2\t2014\t3.64\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t5\t2014\t151.48\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t3\t2014\t20.49\n4550002\tNong Chok/Khlong Sip Song\tApril\t4\t2014\t14.66\n4550019\tLat Krabang/Khlong Sam Prawet\tMarch\t3\t2014\t14.89\n4550013\tNong Chok/Lam Phak Chi\tMarch\t3\t2014\t34.99\n4550019\tLat Krabang/Khlong Sam Prawet\tJanuary\t1\t2014\t16.009999999999998\n4550023\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t27.790000000000003\n4550019\tLat Krabang/Khlong Sam Prawet\tApril\t4\t2014\t6.6\n4550008\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t1.89\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t4\t2014\t5.3500000000000005\n4550028\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t11.15\n4550008\tBang Khen/Tha Raeng\tApril\t4\t2014\t2.45\n4550028\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t46.400000000000006\n4550027\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.0\n4550021\tBang Khae/Bang Phai\tFebruary\t2\t2014\t5.59\n4550020\tLat Krabang/Khum Thong\tFebruary\t2\t2014\t12.020000000000001\n4550017\tHuai Khwang/Bang Kapi\tJanuary\t1\t2014\t3.6999999999999997\n4550022\tPrawet/Nong Bon\tMay\t5\t2014\t80.8\n4550016\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t9.11\n4550011\tBueng Kum/Khlong Kum\tMarch\t3\t2014\t12.540000000000001\n4550007\tNong Chok/Khu Fang Nuea\tApril\t4\t2014\t16.330000000000002\n4550017\tHuai Khwang/Bang Kapi\tMay\t5\t2014\t14.3\n4550024\tBang Bon/Bang Bon\tJanuary\t1\t2014\t9.57\n4550021\tBang Khae/Bang Phai\tApril\t4\t2014\t4.41\n4550028\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.8\n4550008\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t5.16\n4550027\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.9\n4550020\tLat Krabang/Khum Thong\tApril\t4\t2014\t8.02\n4550012\tMin Buri/Saen Saep\tJanuary\t1\t2014\t8.17\n4550003\tLak Si/Thung Song Hong\tFebruary\t2\t2014\t12.719999999999999\n4550001\tDon Mueang/Sanam Bin\tMay\t5\t2014\t13.2\n4550015\tPhaya Thai/Sam Sen Nai\tFebruary\t2\t2014\t11.930000000000001\n4550015\tPhaya Thai/Sam Sen Nai\tJanuary\t1\t2014\t11.120000000000001\n4550007\tNong Chok/Khu Fang Nuea\tFebruary\t2\t2014\t3.2199999999999998\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t3\t2014\t16.88\n4550015\tPhaya Thai/Sam Sen Nai\tMarch\t3\t2014\t13.01\n4550002\tNong Chok/Khlong Sip Song\tMarch\t3\t2014\t12.41\n4550003\tLak Si/Thung Song Hong\tMarch\t3\t2014\t2.6799999999999997\n4550018\tSaphan Sung/Saphan Sung\tFebruary\t2\t2014\t17.349999999999998\n4550009\tNong Chok/Khok Faet\tApril\t4\t2014\t9.77\n4550003\tLak Si/Thung Song Hong\tMay\t5\t2014\t108.66\n4550018\tSaphan Sung/Saphan Sung\tMarch\t3\t2014\t21.35\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t2\t2014\t15.44\n4550015\tPhaya Thai/Sam Sen Nai\tMay\t5\t2014\t53.0\n4550025\tBang Khun Thian/Samae Dam\tFebruary\t2\t2014\t18.759999999999998\n4550007\tNong Chok/Khu Fang Nuea\tJanuary\t1\t2014\t0.99\n4550008\tBang Khen/Tha Raeng\tMarch\t3\t2014\t6.09\n4550008\tBang Khen/Tha Raeng\tMay\t5\t2014\t73.58000000000001\n4550002\tNong Chok/Khlong Sip Song\tJanuary\t1\t2014\t10.64\n4550013\tNong Chok/Lam Phak Chi\tApril\t4\t2014\t14.37\n4550003\tLak Si/Thung Song Hong\tJanuary\t1\t2014\t0.0\n4550024\tBang Bon/Bang Bon\tMay\t5\t2014\t95.72999999999999\n4550002\tNong Chok/Khlong Sip Song\tFebruary\t2\t2014\t16.79\n4550027\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t11.3\n4550010\tLat Phrao/Lat Phrao\tApril\t4\t2014\t12.929999999999998\n4550020\tLat Krabang/Khum Thong\tMarch\t3\t2014\t4.08\n4550020\tLat Krabang/Khum Thong\tJanuary\t1\t2014\t12.3\n4550011\tBueng Kum/Khlong Kum\tApril\t4\t2014\t0.0\n4550028\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t125.76\n4550004\tBang Khen/Tha Raeng\tApril\t4\t2014\t7.6\n4550018\tSaphan Sung/Saphan Sung\tJanuary\t1\t2014\t21.86\n4550010\tLat Phrao/Lat Phrao\tMarch\t3\t2014\t5.359999999999999\n4550007\tNong Chok/Khu Fang Nuea\tMarch\t3\t2014\t50.92999999999999\n4550010\tLat Phrao/Lat Phrao\tJanuary\t1\t2014\t6.890000000000001\n4550027\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t8.2\n4550012\tMin Buri/Saen Saep\tMay\t5\t2014\t33.45\n4550028\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t0.2\n4550002\tNong Chok/Khlong Sip Song\tMay\t5\t2014\t35.91\n4550025\tBang Khun Thian/Samae Dam\tApril\t4\t2014\t21.430000000000003\n4550026\tBang Khun Thian/Tha Kham\tFebruary\t2\t2014\t16.220000000000002\n4550027\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t5.0\n4550016\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t9.13\n4550021\tBang Khae/Bang Phai\tJanuary\t1\t2014\t10.29\n4550022\tPrawet/Nong Bon\tJanuary\t1\t2014\t1.49\n4550004\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t0.0\n4550009\tNong Chok/Khok Faet\tMarch\t3\t2014\t11.389999999999999\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t1\t2014\t1.25\n4550001\tDon Mueang/Sanam Bin\tFebruary\t2\t2014\t0.0\n4550010\tLat Phrao/Lat Phrao\tMay\t5\t2014\t40.739999999999995\n4550017\tHuai Khwang/Bang Kapi\tMarch\t3\t2014\t28.910000000000004\n4550028\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t38.980000000000004\n4550020\tLat Krabang/Khum Thong\tMay\t5\t2014\t59.660000000000004\n4550012\tMin Buri/Saen Saep\tMarch\t3\t2014\t7.08\n4550019\tLat Krabang/Khlong Sam Prawet\tMay\t5\t2014\t0.0\n4550022\tPrawet/Nong Bon\tFebruary\t2\t2014\t20.0\n4550017\tHuai Khwang/Bang Kapi\tFebruary\t2\t2014\t20.73\n4550009\tNong Chok/Khok Faet\tFebruary\t2\t2014\t16.52\n4550024\tBang Bon/Bang Bon\tMarch\t3\t2014\t11.5\n4550023\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t22.84\n4550027\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\n4550024\tBang Bon/Bang Bon\tFebruary\t2\t2014\t36.190000000000005\n4550027\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\n4550021\tBang Khae/Bang Phai\tMay\t5\t2014\t73.0\n4550014\tNong Chok/Krathum Rai\tApril\t4\t2014\t12.76\n4550009\tNong Chok/Khok Faet\tMay\t5\t2014\t0.83\n4550022\tPrawet/Nong Bon\tMarch\t3\t2014\t15.280000000000001\n4550023\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t2.15\n4550028\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t63.43\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t2\t2014\t15.720000000000002\n4550026\tBang Khun Thian/Tha Kham\tMay\t5\t2014\t91.07\n4550028\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.4\n4550014\tNong Chok/Krathum Rai\tMarch\t3\t2014\t2.25\n4550022\tPrawet/Nong Bon\tApril\t4\t2014\t14.629999999999997\n4550028\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\n4550025\tBang Khun Thian/Samae Dam\tMay\t5\t2014\t96.8\n4550017\tHuai Khwang/Bang Kapi\tApril\t4\t2014\t6.710000000000001\n4550016\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t3.13\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t1\t2014\t23.880000000000003\n4550013\tNong Chok/Lam Phak Chi\tFebruary\t2\t2014\t18.560000000000002\n4550001\tDon Mueang/Sanam Bin\tJanuary\t1\t2014\t0.0\n4550015\tPhaya Thai/Sam Sen Nai\tApril\t4\t2014\t7.359999999999999\n4550027\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t18.599999999999998\n4550026\tBang Khun Thian/Tha Kham\tJanuary\t1\t2014\t24.099999999999998\n4550013\tNong Chok/Lam Phak Chi\tJanuary\t1\t2014\t8.690000000000001\n4550012\tMin Buri/Saen Saep\tFebruary\t2\t2014\t20.33\n4550028\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\n4550013\tNong Chok/Lam Phak Chi\tMay\t5\t2014\t0.0\n4550007\tNong Chok/Khu Fang Nuea\tMay\t5\t2014\t84.03\n4550011\tBueng Kum/Khlong Kum\tFebruary\t2\t2014\t11.6\n4550016\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t11.23\n4550023\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t5.87\n4550014\tNong Chok/Krathum Rai\tFebruary\t2\t2014\t3.2800000000000002\n4550027\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t47.699999999999996\n4550001\tDon Mueang/Sanam Bin\tApril\t4\t2014\t9.47\n4550023\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t90.91999999999999\n4550009\tNong Chok/Khok Faet\tJanuary\t1\t2014\t0.8600000000000001\n4550003\tLak Si/Thung Song Hong\tApril\t4\t2014\t1.91\n4550021\tBang Khae/Bang Phai\tMarch\t3\t2014\t12.530000000000001\n4550014\tNong Chok/Krathum Rai\tMay\t5\t2014\t107.71000000000001\n4550012\tMin Buri/Saen Saep\tApril\t4\t2014\t21.720000000000002\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t4\t2014\t5.64\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t5\t2014\t91.25\n4550025\tBang Khun Thian/Samae Dam\tMarch\t3\t2014\t23.66\n4550004\tBang Khen/Tha Raeng\tMarch\t3\t2014\t20.86\n"},{"type":"TEXT","data":"\nDataFrame[StationId: bigint, Location: string, MonthName: string, MonthNo: string, Year: string, sum(DayRainyRate): double]\n"}]},"apps":[],"jobName":"paragraph_1603624634837_-122743207","id":"20201025-111714_732506377","dateCreated":"2020-10-25T11:17:14+0000","dateStarted":"2020-11-08T13:30:07+0000","dateFinished":"2020-11-08T13:30:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"title":"4.2) Reduce - Find average of water-level dataset from 9 stations and union them all to one finally dataset.","text":"%pyspark\ndef reduceCleanWaterLevelData(waterlvDF):\n    return waterlvDF.filter(waterlvDF['Year']==\"2014\").groupBy([\"Station\"]).pivot(\"Month\").mean(\"WaterLavel\")\n\nwaterLevelBKK001SummaryDF = reduceCleanWaterLevelData(waterLevelBKK001CleanDF)\nprint \"Station 'BKK001' was completely reduced\"\n\nwaterLevelBKK003SummaryDF = reduceCleanWaterLevelData(waterLevelBKK003CleanDF)\nprint \"Station 'BKK003' was completely reduced\"\n\nwaterLevelBKK004SummaryDF = reduceCleanWaterLevelData(waterLevelBKK004CleanDF)\nprint \"Station 'BKK004' was completely reduced\"\n\nwaterLevelBKK005SummaryDF = reduceCleanWaterLevelData(waterLevelBKK005CleanDF)\nprint \"Station 'BKK005' was completely reduced\"\n\nwaterLevelBKK008SummaryDF = reduceCleanWaterLevelData(waterLevelBKK008CleanDF)\nprint \"Station 'BKK008' was completely reduced\"\n\nwaterLevelBKK009SummaryDF = reduceCleanWaterLevelData(waterLevelBKK009CleanDF)\nprint \"Station 'BKK009' was completely reduced\"\n\nwaterLevelBKK020SummaryDF = reduceCleanWaterLevelData(waterLevelBKK020CleanDF)\nprint \"Station 'BKK020' was completely reduced\"\n\nwaterLevelBKK021SummaryDF = reduceCleanWaterLevelData(waterLevelBKK021CleanDF)\nprint \"Station 'BKK021' was completely reduced\"\n\nwaterLevelCPY015SummaryDF = reduceCleanWaterLevelData(waterLevelCPY015CleanDF)\nprint \"Station 'CPY015' was completely reduced\"\n\nwaterLevelFinalDF = waterLevelBKK001SummaryDF.union(waterLevelBKK003SummaryDF).union(waterLevelBKK004SummaryDF).union(waterLevelBKK005SummaryDF).union(waterLevelBKK008SummaryDF).union(waterLevelBKK009SummaryDF).union(waterLevelBKK020SummaryDF).union(waterLevelBKK021SummaryDF).union(waterLevelCPY015SummaryDF)\nz.show(waterLevelFinalDF)","user":"anonymous","dateUpdated":"2020-11-08T15:00:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"1":"string","2":"string","3":"string","4":"string","5":"string","6":"string","7":"string","8":"string","9":"string","10":"string","11":"string","12":"string","Station":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"Station","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"1","index":1,"aggr":"avg"},{"name":"2","index":2,"aggr":"avg"},{"name":"3","index":3,"aggr":"avg"},{"name":"4","index":4,"aggr":"avg"},{"name":"5","index":5,"aggr":"avg"},{"name":"6","index":6,"aggr":"avg"},{"name":"7","index":7,"aggr":"avg"},{"name":"8","index":8,"aggr":"avg"},{"name":"9","index":9,"aggr":"avg"},{"name":"10","index":10,"aggr":"avg"},{"name":"11","index":11,"aggr":"avg"},{"name":"12","index":12,"aggr":"avg"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"1":"string","2":"string","3":"string","4":"string","5":"string","6":"string","7":"string","8":"string","9":"string","10":"string","11":"string","12":"string","Station":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Station 'BKK001' was completely reduced\nStation 'BKK003' was completely reduced\nStation 'BKK004' was completely reduced\nStation 'BKK005' was completely reduced\nStation 'BKK008' was completely reduced\nStation 'BKK009' was completely reduced\nStation 'BKK020' was completely reduced\nStation 'BKK021' was completely reduced\nStation 'CPY015' was completely reduced\n"},{"type":"TABLE","data":"Station\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\nBKK001\t-0.033736559139785224\t-0.09489087301587266\t-0.06718189964157614\t-0.12100231481481337\t-0.1000560035842293\t-4.8611111111091827E-4\t0.07310483870967739\t0.2859005376344111\t0.49686342592591376\t0.46486783154121986\t0.07017824074074075\t0.08315188172043125\nBKK003\t0.7388037634408569\t0.7790749007936503\t0.8023745519713245\t0.6482222222222206\t0.5563821684587792\t0.39351157407407356\t0.3970855734767018\t0.46962813620071625\t0.6223101851851877\t0.6377732974910395\t0.7570879629629607\t0.4248835125448032\nBKK004\t0.5165412186379946\t0.5463070436507858\t0.5184923835125449\t0.4258680555555585\t0.3643862007168473\t0.23389120370370334\t0.0\t0.0\t0.0845694444444443\t0.6328785842293879\t0.7187546296296261\t0.5261738351254444\nBKK005\t0.25579749103942695\t0.2699975198412655\t0.254348118279568\t0.1880324074074083\t0.1551164874551973\t0.08342824074074058\t0.1159520609319\t0.1865591397849463\t0.23516203703703834\t0.3729614695340513\t0.3796574074074099\t0.2633534946236567\nBKK008\t0.05332213261648791\t0.02528025793650788\t0.004292114695340425\t-0.0976597222222221\t-0.17682347670251128\t-0.1258819444444445\t-0.12943324372759896\t-0.13806675627240164\t-0.21286805555555552\t-0.19073924731182917\t0.003629629629629544\t0.09369399641577128\nBKK009\t-0.39977374551971573\t-1.0581324404761863\t-0.7251344086021593\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0034791666666666703\t0.025757168458781527\t-0.0948240740740743\t-0.2865681003584185\nBKK020\t0.16056899641576852\t0.060473710317460946\t-0.05504256272401432\t-0.12927083333333156\t-0.08975134408602249\t0.12279629629629632\t0.2741218637992861\t0.7086469534050276\t1.0293634259259308\t0.9909094982078753\t0.7988217592592557\t0.32075716845877805\nBKK021\t1.0358602150537586\t0.9739360119047913\t0.9634744623655737\t0.8536180555555447\t0.8670743727598739\t0.910099537037004\t0.9367047491039292\t1.1518436379928396\t1.2116875000000127\t1.253073476702483\t1.2898981481481453\t1.1348476702509072\nCPY015\t0.45088037634408484\t0.4648685515873004\t0.4668525985663073\t0.32065972222222233\t0.24951612903225773\t0.15922222222222238\t0.13917786738351226\t0.22361111111111137\t0.3845185185185183\t0.44271057347670173\t0.3295949074074083\t0.4974843189964155\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1604121812257_1412141453","id":"20201031-052332_1465106584","dateCreated":"2020-10-31T05:23:32+0000","dateStarted":"2020-11-08T13:30:19+0000","dateFinished":"2020-11-08T13:34:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"title":"4.3) Reduce - 2 Sources integration. Rainy rate data & Water-level data","text":"%pyspark\nimport pyspark.sql.functions as F\nfrom pyspark.sql.types import StringType\n\nbkk001Station = waterLevelBKK001SummaryDF.first()\nbkk004Station = waterLevelBKK004SummaryDF.first()\nbkk005Station = waterLevelBKK005SummaryDF.first()\nbkk008Station = waterLevelBKK008SummaryDF.first()\nbkk009Station = waterLevelBKK009SummaryDF.first()\nbkk021Station = waterLevelBKK021SummaryDF.first()\ncpy015Station = waterLevelCPY015SummaryDF.first()\n\nstationDict = {\n    \"BKK001\": [\"4550004\", \"4550005\", \"4550006\", \"4550020\"],\n    \"BKK004\": [\"4550007\"],\n    \"BKK005\": [\"4550021\", \"4550024\", \"4550025\", \"4550026\"],\n    \"BKK008\": [\"4550003\", \"4550017\", \"4550018\", \"4550022\", \"4550027\"],\n    \"BKK009\": [\"4550002\", \"4550009\", \"4550012\", \"4550013\", \"4550014\", \"4550016\", \"4550019\", \"4550023\"],\n    \"BKK021\": [\"4550001\", \"4550008\", \"4550010\", \"4550011\"],\n    \"CPY015\": [\"4550015\", \"4550028\"]\n}\n\ndef reduceDF(row):\n    stationID = str(row['StationId'])\n    stationCode = \"BKK001\"\n    waterLv= 0.0\n    if stationID in stationDict[\"BKK001\"]:\n        stationCode = \"BKK001\"\n        waterLv = bkk001Station[row['MonthNo']]\n    elif stationID in stationDict[\"BKK004\"]:\n        stationCode = \"BKK004\"\n        waterLv = bkk004Station[row['MonthNo']]\n    elif stationID in stationDict[\"BKK005\"]:\n        stationCode = \"BKK005\"\n        waterLv = bkk005Station[row['MonthNo']]\n    elif stationID in stationDict[\"BKK008\"]:\n        stationCode = \"BKK008\"\n        waterLv = bkk008Station[row['MonthNo']]\n    elif stationID in stationDict[\"BKK009\"]:\n        stationCode = \"BKK009\"\n        waterLv = bkk009Station[row['MonthNo']]\n    elif stationID in stationDict[\"BKK021\"]:\n        stationCode = \"BKK021\"\n        waterLv = bkk021Station[row['MonthNo']]\n    elif stationID in stationDict[\"CPY015\"]:\n        stationCode = \"CPY015\"\n        waterLv = cpy015Station[row['MonthNo']]\n    else:\n        print \"Station Id: {} not in configuration\".format(stationID)\n    return (\n        row['Location'], row['MonthName'], round(row['sum(DayRainyRate)'],2), round(waterLv,2), row['Location']+\" (\"+row['MonthName']+\")\"\n    )\n\nintegratedDF = groupByMYDF.rdd.map(reduceDF).toDF(['Location', 'Month', 'MonthlyRainyRate', 'MonthlyWaterLevel', 'LocationAndMonth']).sort('Month', ascending=True)\nz.show(integratedDF)\n","user":"anonymous","dateUpdated":"2020-11-14T04:43:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Month","visible":true,"width":150,"sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyRainyRate","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyWaterLevel","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","Month":"string","MonthlyRainyRate":"string","MonthlyWaterLevel":"string","LocationAndMonth":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Month","index":1,"aggr":"sum"},"yAxis":{"name":"MonthlyWaterLevel","index":3,"aggr":"sum"},"group":{"name":"Location","index":0,"aggr":"sum"},"size":{"name":"MonthlyRainyRate","index":2,"aggr":"sum"}},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"Month","index":1,"aggr":"sum"}],"values":[{"name":"MonthlyWaterLevel","index":3,"aggr":"sum"},{"name":"MonthlyRainyRate","index":2,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Month":"string","MonthlyRainyRate":"string","MonthlyWaterLevel":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Location\tMonth\tMonthlyRainyRate\tMonthlyWaterLevel\tLocationAndMonth\nNong Chok/Khu Fang Nuea\tApril\t16.33\t0.43\tNong Chok/Khu Fang Nuea (April)\nBang Khen/Tha Raeng\tApril\t7.6\t-0.12\tBang Khen/Tha Raeng (April)\nNong Chok/Khlong Sip Song\tApril\t14.66\t0.0\tNong Chok/Khlong Sip Song (April)\nBang Khae/Bang Phai\tApril\t4.41\t0.19\tBang Khae/Bang Phai (April)\nKhlong Toei/Khlong Toei\tApril\t0.9\t-0.1\tKhlong Toei/Khlong Toei (April)\nBang Khun Thian/Samae Dam\tApril\t21.43\t0.19\tBang Khun Thian/Samae Dam (April)\nLat Krabang/Khum Thong\tApril\t8.02\t-0.12\tLat Krabang/Khum Thong (April)\nLat Krabang/Khlong Sam Prawet\tApril\t6.6\t0.0\tLat Krabang/Khlong Sam Prawet (April)\nKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t5.35\t-0.12\tKhlong Sam Wa/Sam Wa Tawan Ok (April)\nBang Bon/Bang Bon\tApril\t8.02\t0.19\tBang Bon/Bang Bon (April)\nBang Khen/Tha Raeng\tApril\t2.45\t0.85\tBang Khen/Tha Raeng (April)\nNong Chok/Krathum Rai\tApril\t12.76\t0.0\tNong Chok/Krathum Rai (April)\nLat Krabang/Lam Pla Thio\tApril\t2.15\t0.0\tLat Krabang/Lam Pla Thio (April)\nSaphan Sung/Saphan Sung\tApril\t19.36\t-0.1\tSaphan Sung/Saphan Sung (April)\nNong Chok/Khok Faet\tApril\t9.77\t0.0\tNong Chok/Khok Faet (April)\nKhlong Toei/Khlong Toei\tApril\t0.4\t0.32\tKhlong Toei/Khlong Toei (April)\nPrawet/Nong Bon\tApril\t14.63\t-0.1\tPrawet/Nong Bon (April)\nHuai Khwang/Bang Kapi\tApril\t6.71\t-0.1\tHuai Khwang/Bang Kapi (April)\nPhaya Thai/Sam Sen Nai\tApril\t7.36\t0.32\tPhaya Thai/Sam Sen Nai (April)\nBang Khun Thian/Tha Kham\tApril\t4.58\t0.19\tBang Khun Thian/Tha Kham (April)\nLat Krabang/Lam Pla Thio\tApril\t11.23\t0.0\tLat Krabang/Lam Pla Thio (April)\nLat Phrao/Lat Phrao\tApril\t12.93\t0.85\tLat Phrao/Lat Phrao (April)\nDon Mueang/Sanam Bin\tApril\t9.47\t0.85\tDon Mueang/Sanam Bin (April)\nNong Chok/Lam Phak Chi\tApril\t14.37\t0.0\tNong Chok/Lam Phak Chi (April)\nBueng Kum/Khlong Kum\tApril\t0.0\t0.85\tBueng Kum/Khlong Kum (April)\nKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t5.64\t-0.12\tKhlong Sam Wa/Sam Wa Tawan Tok (April)\nMin Buri/Saen Saep\tApril\t21.72\t0.0\tMin Buri/Saen Saep (April)\nLak Si/Thung Song Hong\tApril\t1.91\t-0.1\tLak Si/Thung Song Hong (April)\nKhlong Toei/Khlong Toei\tAugust\t5.0\t-0.14\tKhlong Toei/Khlong Toei (August)\nKhlong Toei/Khlong Toei\tAugust\t11.15\t0.22\tKhlong Toei/Khlong Toei (August)\nKhlong Toei/Khlong Toei\tDecember\t0.0\t0.09\tKhlong Toei/Khlong Toei (December)\nKhlong Toei/Khlong Toei\tDecember\t0.0\t0.5\tKhlong Toei/Khlong Toei (December)\nBang Khen/Tha Raeng\tFebruary\t5.16\t0.97\tBang Khen/Tha Raeng (February)\nBang Bon/Bang Bon\tFebruary\t36.19\t0.27\tBang Bon/Bang Bon (February)\nLat Krabang/Lam Pla Thio\tFebruary\t22.84\t-1.06\tLat Krabang/Lam Pla Thio (February)\nSaphan Sung/Saphan Sung\tFebruary\t17.35\t0.03\tSaphan Sung/Saphan Sung (February)\nLat Phrao/Lat Phrao\tFebruary\t3.64\t0.97\tLat Phrao/Lat Phrao (February)\nLat Krabang/Khlong Sam Prawet\tFebruary\t22.79\t-1.06\tLat Krabang/Khlong Sam Prawet (February)\nKhlong Toei/Khlong Toei\tFebruary\t1.8\t0.46\tKhlong Toei/Khlong Toei (February)\nBang Khun Thian/Tha Kham\tFebruary\t16.22\t0.27\tBang Khun Thian/Tha Kham (February)\nLat Krabang/Lam Pla Thio\tFebruary\t9.13\t-1.06\tLat Krabang/Lam Pla Thio (February)\nBang Khen/Tha Raeng\tFebruary\t0.0\t-0.09\tBang Khen/Tha Raeng (February)\nDon Mueang/Sanam Bin\tFebruary\t0.0\t0.97\tDon Mueang/Sanam Bin (February)\nLak Si/Thung Song Hong\tFebruary\t12.72\t0.03\tLak Si/Thung Song Hong (February)\nNong Chok/Khu Fang Nuea\tFebruary\t3.22\t0.55\tNong Chok/Khu Fang Nuea (February)\nPhaya Thai/Sam Sen Nai\tFebruary\t11.93\t0.46\tPhaya Thai/Sam Sen Nai (February)\nNong Chok/Khok Faet\tFebruary\t16.52\t-1.06\tNong Chok/Khok Faet (February)\nHuai Khwang/Bang Kapi\tFebruary\t20.73\t0.03\tHuai Khwang/Bang Kapi (February)\nPrawet/Nong Bon\tFebruary\t20.0\t0.03\tPrawet/Nong Bon (February)\nKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t15.72\t-0.09\tKhlong Sam Wa/Sam Wa Tawan Ok (February)\nBang Khun Thian/Samae Dam\tFebruary\t18.76\t0.27\tBang Khun Thian/Samae Dam (February)\nKhlong Toei/Khlong Toei\tFebruary\t1.0\t0.03\tKhlong Toei/Khlong Toei (February)\nKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t15.44\t-0.09\tKhlong Sam Wa/Sam Wa Tawan Tok (February)\nNong Chok/Lam Phak Chi\tFebruary\t18.56\t-1.06\tNong Chok/Lam Phak Chi (February)\nLat Krabang/Khum Thong\tFebruary\t12.02\t-0.09\tLat Krabang/Khum Thong (February)\nMin Buri/Saen Saep\tFebruary\t20.33\t-1.06\tMin Buri/Saen Saep (February)\nBang Khae/Bang Phai\tFebruary\t5.59\t0.27\tBang Khae/Bang Phai (February)\nBueng Kum/Khlong Kum\tFebruary\t11.6\t0.97\tBueng Kum/Khlong Kum (February)\nNong Chok/Krathum Rai\tFebruary\t3.28\t-1.06\tNong Chok/Krathum Rai (February)\nNong Chok/Khlong Sip Song\tFebruary\t16.79\t-1.06\tNong Chok/Khlong Sip Song (February)\nSaphan Sung/Saphan Sung\tJanuary\t21.86\t0.05\tSaphan Sung/Saphan Sung (January)\nLat Phrao/Lat Phrao\tJanuary\t6.89\t1.04\tLat Phrao/Lat Phrao (January)\nLat Krabang/Lam Pla Thio\tJanuary\t27.79\t-0.4\tLat Krabang/Lam Pla Thio (January)\nBang Khae/Bang Phai\tJanuary\t10.29\t0.26\tBang Khae/Bang Phai (January)\nPrawet/Nong Bon\tJanuary\t1.49\t0.05\tPrawet/Nong Bon (January)\nNong Chok/Krathum Rai\tJanuary\t15.51\t-0.4\tNong Chok/Krathum Rai (January)\nBang Khun Thian/Samae Dam\tJanuary\t30.98\t0.26\tBang Khun Thian/Samae Dam (January)\nBueng Kum/Khlong Kum\tJanuary\t6.42\t1.04\tBueng Kum/Khlong Kum (January)\nKhlong Toei/Khlong Toei\tJanuary\t0.0\t0.45\tKhlong Toei/Khlong Toei (January)\nNong Chok/Khu Fang Nuea\tJanuary\t0.99\t0.52\tNong Chok/Khu Fang Nuea (January)\nLat Krabang/Lam Pla Thio\tJanuary\t3.13\t-0.4\tLat Krabang/Lam Pla Thio (January)\nHuai Khwang/Bang Kapi\tJanuary\t3.7\t0.05\tHuai Khwang/Bang Kapi (January)\nNong Chok/Khlong Sip Song\tJanuary\t10.64\t-0.4\tNong Chok/Khlong Sip Song (January)\nBang Khun Thian/Tha Kham\tJanuary\t24.1\t0.26\tBang Khun Thian/Tha Kham (January)\nBang Bon/Bang Bon\tJanuary\t9.57\t0.26\tBang Bon/Bang Bon (January)\nBang Khen/Tha Raeng\tJanuary\t0.0\t-0.03\tBang Khen/Tha Raeng (January)\nMin Buri/Saen Saep\tJanuary\t8.17\t-0.4\tMin Buri/Saen Saep (January)\nKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t1.25\t-0.03\tKhlong Sam Wa/Sam Wa Tawan Ok (January)\nPhaya Thai/Sam Sen Nai\tJanuary\t11.12\t0.45\tPhaya Thai/Sam Sen Nai (January)\nLat Krabang/Khlong Sam Prawet\tJanuary\t16.01\t-0.4\tLat Krabang/Khlong Sam Prawet (January)\nBang Khen/Tha Raeng\tJanuary\t1.89\t1.04\tBang Khen/Tha Raeng (January)\nKhlong Toei/Khlong Toei\tJanuary\t0.0\t0.05\tKhlong Toei/Khlong Toei (January)\nKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t23.88\t-0.03\tKhlong Sam Wa/Sam Wa Tawan Tok (January)\nDon Mueang/Sanam Bin\tJanuary\t0.0\t1.04\tDon Mueang/Sanam Bin (January)\nNong Chok/Lam Phak Chi\tJanuary\t8.69\t-0.4\tNong Chok/Lam Phak Chi (January)\nLak Si/Thung Song Hong\tJanuary\t0.0\t0.05\tLak Si/Thung Song Hong (January)\nNong Chok/Khok Faet\tJanuary\t0.86\t-0.4\tNong Chok/Khok Faet (January)\nLat Krabang/Khum Thong\tJanuary\t12.3\t-0.03\tLat Krabang/Khum Thong (January)\nKhlong Toei/Khlong Toei\tJuly\t38.4\t-0.13\tKhlong Toei/Khlong Toei (July)\nKhlong Toei/Khlong Toei\tJuly\t125.76\t0.14\tKhlong Toei/Khlong Toei (July)\nKhlong Toei/Khlong Toei\tJune\t63.43\t0.16\tKhlong Toei/Khlong Toei (June)\nKhlong Toei/Khlong Toei\tJune\t11.3\t-0.13\tKhlong Toei/Khlong Toei (June)\nNong Chok/Lam Phak Chi\tMarch\t34.99\t-0.73\tNong Chok/Lam Phak Chi (March)\nNong Chok/Khu Fang Nuea\tMarch\t50.93\t0.52\tNong Chok/Khu Fang Nuea (March)\nNong Chok/Khok Faet\tMarch\t11.39\t-0.73\tNong Chok/Khok Faet (March)\nNong Chok/Khlong Sip Song\tMarch\t12.41\t-0.73\tNong Chok/Khlong Sip Song (March)\nPrawet/Nong Bon\tMarch\t15.28\t0.0\tPrawet/Nong Bon (March)\nBang Khun Thian/Tha Kham\tMarch\t5.92\t0.25\tBang Khun Thian/Tha Kham (March)\nBang Khen/Tha Raeng\tMarch\t6.09\t0.96\tBang Khen/Tha Raeng (March)\nKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t20.49\t-0.07\tKhlong Sam Wa/Sam Wa Tawan Tok (March)\nLat Krabang/Khlong Sam Prawet\tMarch\t14.89\t-0.73\tLat Krabang/Khlong Sam Prawet (March)\nLat Phrao/Lat Phrao\tMarch\t5.36\t0.96\tLat Phrao/Lat Phrao (March)\nKhlong Toei/Khlong Toei\tMarch\t0.2\t0.47\tKhlong Toei/Khlong Toei (March)\nHuai Khwang/Bang Kapi\tMarch\t28.91\t0.0\tHuai Khwang/Bang Kapi (March)\nPhaya Thai/Sam Sen Nai\tMarch\t13.01\t0.47\tPhaya Thai/Sam Sen Nai (March)\nBang Bon/Bang Bon\tMarch\t11.5\t0.25\tBang Bon/Bang Bon (March)\nLak Si/Thung Song Hong\tMarch\t2.68\t0.0\tLak Si/Thung Song Hong (March)\nKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t16.88\t-0.07\tKhlong Sam Wa/Sam Wa Tawan Ok (March)\nLat Krabang/Khum Thong\tMarch\t4.08\t-0.07\tLat Krabang/Khum Thong (March)\nLat Krabang/Lam Pla Thio\tMarch\t5.87\t-0.73\tLat Krabang/Lam Pla Thio (March)\nKhlong Toei/Khlong Toei\tMarch\t47.7\t0.0\tKhlong Toei/Khlong Toei (March)\nLat Krabang/Lam Pla Thio\tMarch\t18.51\t-0.73\tLat Krabang/Lam Pla Thio (March)\nBang Khun Thian/Samae Dam\tMarch\t23.66\t0.25\tBang Khun Thian/Samae Dam (March)\nBueng Kum/Khlong Kum\tMarch\t12.54\t0.96\tBueng Kum/Khlong Kum (March)\nBang Khen/Tha Raeng\tMarch\t20.86\t-0.07\tBang Khen/Tha Raeng (March)\nMin Buri/Saen Saep\tMarch\t7.08\t-0.73\tMin Buri/Saen Saep (March)\nSaphan Sung/Saphan Sung\tMarch\t21.35\t0.0\tSaphan Sung/Saphan Sung (March)\nNong Chok/Krathum Rai\tMarch\t2.25\t-0.73\tNong Chok/Krathum Rai (March)\nDon Mueang/Sanam Bin\tMarch\t13.91\t0.96\tDon Mueang/Sanam Bin (March)\nBang Khae/Bang Phai\tMarch\t12.53\t0.25\tBang Khae/Bang Phai (March)\nSaphan Sung/Saphan Sung\tMay\t40.63\t-0.18\tSaphan Sung/Saphan Sung (May)\nBueng Kum/Khlong Kum\tMay\t18.6\t0.87\tBueng Kum/Khlong Kum (May)\nDon Mueang/Sanam Bin\tMay\t13.2\t0.87\tDon Mueang/Sanam Bin (May)\nBang Khen/Tha Raeng\tMay\t114.27\t-0.1\tBang Khen/Tha Raeng (May)\nKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t151.48\t-0.1\tKhlong Sam Wa/Sam Wa Tawan Ok (May)\nPrawet/Nong Bon\tMay\t80.8\t-0.18\tPrawet/Nong Bon (May)\nHuai Khwang/Bang Kapi\tMay\t14.3\t-0.18\tHuai Khwang/Bang Kapi (May)\nMin Buri/Saen Saep\tMay\t33.45\t0.0\tMin Buri/Saen Saep (May)\nLat Phrao/Lat Phrao\tMay\t40.74\t0.87\tLat Phrao/Lat Phrao (May)\nBang Khae/Bang Phai\tMay\t73.0\t0.16\tBang Khae/Bang Phai (May)\nKhlong Toei/Khlong Toei\tMay\t46.4\t0.25\tKhlong Toei/Khlong Toei (May)\nLak Si/Thung Song Hong\tMay\t108.66\t-0.18\tLak Si/Thung Song Hong (May)\nLat Krabang/Lam Pla Thio\tMay\t9.11\t0.0\tLat Krabang/Lam Pla Thio (May)\nLat Krabang/Lam Pla Thio\tMay\t90.92\t0.0\tLat Krabang/Lam Pla Thio (May)\nBang Bon/Bang Bon\tMay\t95.73\t0.16\tBang Bon/Bang Bon (May)\nKhlong Toei/Khlong Toei\tMay\t8.2\t-0.18\tKhlong Toei/Khlong Toei (May)\nNong Chok/Khlong Sip Song\tMay\t35.91\t0.0\tNong Chok/Khlong Sip Song (May)\nLat Krabang/Khum Thong\tMay\t59.66\t-0.1\tLat Krabang/Khum Thong (May)\nLat Krabang/Khlong Sam Prawet\tMay\t0.0\t0.0\tLat Krabang/Khlong Sam Prawet (May)\nNong Chok/Khok Faet\tMay\t0.83\t0.0\tNong Chok/Khok Faet (May)\nPhaya Thai/Sam Sen Nai\tMay\t53.0\t0.25\tPhaya Thai/Sam Sen Nai (May)\nBang Khen/Tha Raeng\tMay\t73.58\t0.87\tBang Khen/Tha Raeng (May)\nNong Chok/Khu Fang Nuea\tMay\t84.03\t0.36\tNong Chok/Khu Fang Nuea (May)\nNong Chok/Krathum Rai\tMay\t107.71\t0.0\tNong Chok/Krathum Rai (May)\nKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t91.25\t-0.1\tKhlong Sam Wa/Sam Wa Tawan Tok (May)\nBang Khun Thian/Tha Kham\tMay\t91.07\t0.16\tBang Khun Thian/Tha Kham (May)\nBang Khun Thian/Samae Dam\tMay\t96.8\t0.16\tBang Khun Thian/Samae Dam (May)\nNong Chok/Lam Phak Chi\tMay\t0.0\t0.0\tNong Chok/Lam Phak Chi (May)\nKhlong Toei/Khlong Toei\tNovember\t38.98\t0.33\tKhlong Toei/Khlong Toei (November)\nKhlong Toei/Khlong Toei\tNovember\t18.6\t0.0\tKhlong Toei/Khlong Toei (November)\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1604733693112_385354186","id":"20201107-072133_1583704739","dateCreated":"2020-11-07T07:21:33+0000","dateStarted":"2020-11-08T14:26:13+0000","dateFinished":"2020-11-08T14:28:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"title":"4.3) Standardization MonthlyRainyRate and MonthlyWaterLevel by MinMaxScaler","text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import MinMaxScaler\nfrom pyspark.ml.feature import VectorAssembler\n\ntargetColumnsScale = [\"MonthlyRainyRate\", \"MonthlyWaterLevel\"]\nassemblers = [VectorAssembler(inputCols=[col], outputCol=col + \"Vector\") for col in targetColumnsScale]\nscalers = [MinMaxScaler(inputCol=col + \"Vector\", outputCol=col + \"Scaled\") for col in targetColumnsScale]\npipeline = Pipeline(stages=assemblers+scalers)\nscalerModel = pipeline.fit(integratedDF)\nscaledRainyRateAndWaterLvDF = scalerModel.transform(integratedDF)\nz.show(scaledRainyRateAndWaterLvDF)","user":"anonymous","dateUpdated":"2020-11-14T03:20:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":404,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Month","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyRainyRate","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyWaterLevel","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"LocationAndMonth","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyRainyRateVector","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyWaterLevelVector","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyRainyRateScaled","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthlyWaterLevelScaled","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","Month":"string","MonthlyRainyRate":"string","MonthlyWaterLevel":"string","LocationAndMonth":"string","MonthlyRainyRateVector":"string","MonthlyWaterLevelVector":"string","MonthlyRainyRateScaled":"string","MonthlyWaterLevelScaled":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"MonthlyRainyRateScaled","index":7,"aggr":"sum"},"yAxis":{"name":"MonthlyWaterLevelScaled","index":8,"aggr":"sum"},"group":{"name":"Location","index":0,"aggr":"sum"}},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"keys":[],"groups":[{"name":"Month","index":1,"aggr":"sum"}],"values":[]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Location\tMonth\tMonthlyRainyRate\tMonthlyWaterLevel\tLocationAndMonth\tMonthlyRainyRateVector\tMonthlyWaterLevelVector\tMonthlyRainyRateScaled\tMonthlyWaterLevelScaled\nBang Khun Thian/Tha Kham\tApril\t4.58\t0.19\tBang Khun Thian/Tha Kham (April)\t[4.58]\t[0.19]\t[0.030235014523369425]\t[0.5952380952380952]\nNong Chok/Khlong Sip Song\tApril\t14.66\t0.0\tNong Chok/Khlong Sip Song (April)\t[14.66]\t[0.0]\t[0.09677845260100344]\t[0.5047619047619047]\nLat Krabang/Khlong Sam Prawet\tApril\t6.6\t0.0\tLat Krabang/Khlong Sam Prawet (April)\t[6.6]\t[0.0]\t[0.04357010826511751]\t[0.5047619047619047]\nKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t5.35\t-0.12\tKhlong Sam Wa/Sam Wa Tawan Ok (April)\t[5.35]\t[-0.12]\t[0.035318193820966466]\t[0.44761904761904764]\nBang Khen/Tha Raeng\tApril\t2.45\t0.85\tBang Khen/Tha Raeng (April)\t[2.45]\t[0.85]\t[0.016173752310536048]\t[0.9095238095238095]\nNong Chok/Khu Fang Nuea\tApril\t16.33\t0.43\tNong Chok/Khu Fang Nuea (April)\t[16.33]\t[0.43]\t[0.10780301029838922]\t[0.7095238095238094]\nBang Khae/Bang Phai\tApril\t4.41\t0.19\tBang Khae/Bang Phai (April)\t[4.41]\t[0.19]\t[0.029112754158964884]\t[0.5952380952380952]\nLat Phrao/Lat Phrao\tApril\t12.93\t0.85\tLat Phrao/Lat Phrao (April)\t[12.93]\t[0.85]\t[0.0853578030102984]\t[0.9095238095238095]\nBueng Kum/Khlong Kum\tApril\t0.0\t0.85\tBueng Kum/Khlong Kum (April)\t[0.0]\t[0.85]\t[0.0]\t[0.9095238095238095]\nLat Krabang/Lam Pla Thio\tApril\t2.15\t0.0\tLat Krabang/Lam Pla Thio (April)\t[2.15]\t[0.0]\t[0.014193292843939794]\t[0.5047619047619047]\nPhaya Thai/Sam Sen Nai\tApril\t7.36\t0.32\tPhaya Thai/Sam Sen Nai (April)\t[7.36]\t[0.32]\t[0.04858727224716135]\t[0.6571428571428571]\nLak Si/Thung Song Hong\tApril\t1.91\t-0.1\tLak Si/Thung Song Hong (April)\t[1.91]\t[-0.1]\t[0.012608925270662794]\t[0.4571428571428572]\nSaphan Sung/Saphan Sung\tApril\t19.36\t-0.1\tSaphan Sung/Saphan Sung (April)\t[19.36]\t[-0.1]\t[0.12780565091101137]\t[0.4571428571428572]\nBang Bon/Bang Bon\tApril\t8.02\t0.19\tBang Bon/Bang Bon (April)\t[8.02]\t[0.19]\t[0.05294428307367309]\t[0.5952380952380952]\nKhlong Toei/Khlong Toei\tApril\t0.9\t-0.1\tKhlong Toei/Khlong Toei (April)\t[0.9]\t[-0.1]\t[0.005941378399788751]\t[0.4571428571428572]\nLat Krabang/Khum Thong\tApril\t8.02\t-0.12\tLat Krabang/Khum Thong (April)\t[8.02]\t[-0.12]\t[0.05294428307367309]\t[0.44761904761904764]\nNong Chok/Khok Faet\tApril\t9.77\t0.0\tNong Chok/Khok Faet (April)\t[9.77]\t[0.0]\t[0.06449696329548456]\t[0.5047619047619047]\nNong Chok/Lam Phak Chi\tApril\t14.37\t0.0\tNong Chok/Lam Phak Chi (April)\t[14.37]\t[0.0]\t[0.09486400844996039]\t[0.5047619047619047]\nBang Khen/Tha Raeng\tApril\t7.6\t-0.12\tBang Khen/Tha Raeng (April)\t[7.6]\t[-0.12]\t[0.05017163982043834]\t[0.44761904761904764]\nBang Khun Thian/Samae Dam\tApril\t21.43\t0.19\tBang Khun Thian/Samae Dam (April)\t[21.43]\t[0.19]\t[0.14147082123052548]\t[0.5952380952380952]\nNong Chok/Krathum Rai\tApril\t12.76\t0.0\tNong Chok/Krathum Rai (April)\t[12.76]\t[0.0]\t[0.08423554264589385]\t[0.5047619047619047]\nKhlong Toei/Khlong Toei\tApril\t0.4\t0.32\tKhlong Toei/Khlong Toei (April)\t[0.4]\t[0.32]\t[0.002640612622128334]\t[0.6571428571428571]\nPrawet/Nong Bon\tApril\t14.63\t-0.1\tPrawet/Nong Bon (April)\t[14.63]\t[-0.1]\t[0.09658040665434382]\t[0.4571428571428572]\nHuai Khwang/Bang Kapi\tApril\t6.71\t-0.1\tHuai Khwang/Bang Kapi (April)\t[6.71]\t[-0.1]\t[0.0442962767362028]\t[0.4571428571428572]\nLat Krabang/Lam Pla Thio\tApril\t11.23\t0.0\tLat Krabang/Lam Pla Thio (April)\t[11.23]\t[0.0]\t[0.07413519936625299]\t[0.5047619047619047]\nDon Mueang/Sanam Bin\tApril\t9.47\t0.85\tDon Mueang/Sanam Bin (April)\t[9.47]\t[0.85]\t[0.0625165038288883]\t[0.9095238095238095]\nMin Buri/Saen Saep\tApril\t21.72\t0.0\tMin Buri/Saen Saep (April)\t[21.72]\t[0.0]\t[0.14338526538156854]\t[0.5047619047619047]\nKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t5.64\t-0.12\tKhlong Sam Wa/Sam Wa Tawan Tok (April)\t[5.64]\t[-0.12]\t[0.03723263797200951]\t[0.44761904761904764]\nKhlong Toei/Khlong Toei\tAugust\t11.15\t0.22\tKhlong Toei/Khlong Toei (August)\t[11.15]\t[0.22]\t[0.07360707684182731]\t[0.6095238095238095]\nKhlong Toei/Khlong Toei\tAugust\t5.0\t-0.14\tKhlong Toei/Khlong Toei (August)\t[5.0]\t[-0.14]\t[0.03300765777660417]\t[0.4380952380952381]\nKhlong Toei/Khlong Toei\tDecember\t0.0\t0.5\tKhlong Toei/Khlong Toei (December)\t[0.0]\t[0.5]\t[0.0]\t[0.7428571428571429]\nKhlong Toei/Khlong Toei\tDecember\t0.0\t0.09\tKhlong Toei/Khlong Toei (December)\t[0.0]\t[0.09]\t[0.0]\t[0.5476190476190477]\nKhlong Toei/Khlong Toei\tFebruary\t1.0\t0.03\tKhlong Toei/Khlong Toei (February)\t[1.0]\t[0.03]\t[0.006601531555320835]\t[0.5190476190476191]\nBang Khae/Bang Phai\tFebruary\t5.59\t0.27\tBang Khae/Bang Phai (February)\t[5.59]\t[0.27]\t[0.036902561394243465]\t[0.6333333333333333]\nLat Krabang/Khum Thong\tFebruary\t12.02\t-0.09\tLat Krabang/Khum Thong (February)\t[12.02]\t[-0.09]\t[0.07935040929495643]\t[0.46190476190476193]\nBang Khen/Tha Raeng\tFebruary\t5.16\t0.97\tBang Khen/Tha Raeng (February)\t[5.16]\t[0.97]\t[0.03406390282545551]\t[0.9666666666666668]\nSaphan Sung/Saphan Sung\tFebruary\t17.35\t0.03\tSaphan Sung/Saphan Sung (February)\t[17.35]\t[0.03]\t[0.1145365724848165]\t[0.5190476190476191]\nKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t15.44\t-0.09\tKhlong Sam Wa/Sam Wa Tawan Tok (February)\t[15.44]\t[-0.09]\t[0.10192764721415369]\t[0.46190476190476193]\nNong Chok/Khlong Sip Song\tFebruary\t16.79\t-1.06\tNong Chok/Khlong Sip Song (February)\t[16.79]\t[-1.06]\t[0.11083971481383681]\t[0.0]\nLat Krabang/Lam Pla Thio\tFebruary\t9.13\t-1.06\tLat Krabang/Lam Pla Thio (February)\t[9.13]\t[-1.06]\t[0.06027198310007923]\t[0.0]\nPrawet/Nong Bon\tFebruary\t20.0\t0.03\tPrawet/Nong Bon (February)\t[20.0]\t[0.03]\t[0.1320306311064167]\t[0.5190476190476191]\nLat Krabang/Lam Pla Thio\tFebruary\t22.84\t-1.06\tLat Krabang/Lam Pla Thio (February)\t[22.84]\t[-1.06]\t[0.15077898072352786]\t[0.0]\nKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t15.72\t-0.09\tKhlong Sam Wa/Sam Wa Tawan Ok (February)\t[15.72]\t[-0.09]\t[0.10377607604964353]\t[0.46190476190476193]\nBueng Kum/Khlong Kum\tFebruary\t11.6\t0.97\tBueng Kum/Khlong Kum (February)\t[11.6]\t[0.97]\t[0.07657776604172169]\t[0.9666666666666668]\nLat Krabang/Khlong Sam Prawet\tFebruary\t22.79\t-1.06\tLat Krabang/Khlong Sam Prawet (February)\t[22.79]\t[-1.06]\t[0.1504489041457618]\t[0.0]\nLat Phrao/Lat Phrao\tFebruary\t3.64\t0.97\tLat Phrao/Lat Phrao (February)\t[3.64]\t[0.97]\t[0.02402957486136784]\t[0.9666666666666668]\nKhlong Toei/Khlong Toei\tFebruary\t1.8\t0.46\tKhlong Toei/Khlong Toei (February)\t[1.8]\t[0.46]\t[0.011882756799577503]\t[0.7238095238095238]\nLak Si/Thung Song Hong\tFebruary\t12.72\t0.03\tLak Si/Thung Song Hong (February)\t[12.72]\t[0.03]\t[0.08397148138368102]\t[0.5190476190476191]\nPhaya Thai/Sam Sen Nai\tFebruary\t11.93\t0.46\tPhaya Thai/Sam Sen Nai (February)\t[11.93]\t[0.46]\t[0.07875627145497756]\t[0.7238095238095238]\nNong Chok/Khu Fang Nuea\tFebruary\t3.22\t0.55\tNong Chok/Khu Fang Nuea (February)\t[3.22]\t[0.55]\t[0.02125693160813309]\t[0.7666666666666667]\nBang Khun Thian/Samae Dam\tFebruary\t18.76\t0.27\tBang Khun Thian/Samae Dam (February)\t[18.76]\t[0.27]\t[0.12384473197781887]\t[0.6333333333333333]\nBang Khun Thian/Tha Kham\tFebruary\t16.22\t0.27\tBang Khun Thian/Tha Kham (February)\t[16.22]\t[0.27]\t[0.10707684182730394]\t[0.6333333333333333]\nBang Khen/Tha Raeng\tFebruary\t0.0\t-0.09\tBang Khen/Tha Raeng (February)\t[0.0]\t[-0.09]\t[0.0]\t[0.46190476190476193]\nDon Mueang/Sanam Bin\tFebruary\t0.0\t0.97\tDon Mueang/Sanam Bin (February)\t[0.0]\t[0.97]\t[0.0]\t[0.9666666666666668]\nHuai Khwang/Bang Kapi\tFebruary\t20.73\t0.03\tHuai Khwang/Bang Kapi (February)\t[20.73]\t[0.03]\t[0.1368497491418009]\t[0.5190476190476191]\nNong Chok/Khok Faet\tFebruary\t16.52\t-1.06\tNong Chok/Khok Faet (February)\t[16.52]\t[-1.06]\t[0.10905730129390019]\t[0.0]\nBang Bon/Bang Bon\tFebruary\t36.19\t0.27\tBang Bon/Bang Bon (February)\t[36.19]\t[0.27]\t[0.238909426987061]\t[0.6333333333333333]\nNong Chok/Lam Phak Chi\tFebruary\t18.56\t-1.06\tNong Chok/Lam Phak Chi (February)\t[18.56]\t[-1.06]\t[0.12252442566675469]\t[0.0]\nMin Buri/Saen Saep\tFebruary\t20.33\t-1.06\tMin Buri/Saen Saep (February)\t[20.33]\t[-1.06]\t[0.13420913651967256]\t[0.0]\nNong Chok/Krathum Rai\tFebruary\t3.28\t-1.06\tNong Chok/Krathum Rai (February)\t[3.28]\t[-1.06]\t[0.02165302350145234]\t[0.0]\nBang Khen/Tha Raeng\tJanuary\t0.0\t-0.03\tBang Khen/Tha Raeng (January)\t[0.0]\t[-0.03]\t[0.0]\t[0.49047619047619045]\nLat Krabang/Lam Pla Thio\tJanuary\t27.79\t-0.4\tLat Krabang/Lam Pla Thio (January)\t[27.79]\t[-0.4]\t[0.183456561922366]\t[0.3142857142857143]\nBang Bon/Bang Bon\tJanuary\t9.57\t0.26\tBang Bon/Bang Bon (January)\t[9.57]\t[0.26]\t[0.06317665698442039]\t[0.6285714285714286]\nMin Buri/Saen Saep\tJanuary\t8.17\t-0.4\tMin Buri/Saen Saep (January)\t[8.17]\t[-0.4]\t[0.05393451280697122]\t[0.3142857142857143]\nPhaya Thai/Sam Sen Nai\tJanuary\t11.12\t0.45\tPhaya Thai/Sam Sen Nai (January)\t[11.12]\t[0.45]\t[0.07340903089516768]\t[0.719047619047619]\nNong Chok/Khu Fang Nuea\tJanuary\t0.99\t0.52\tNong Chok/Khu Fang Nuea (January)\t[0.99]\t[0.52]\t[0.006535516239767627]\t[0.7523809523809524]\nNong Chok/Khlong Sip Song\tJanuary\t10.64\t-0.4\tNong Chok/Khlong Sip Song (January)\t[10.64]\t[-0.4]\t[0.0702402957486137]\t[0.3142857142857143]\nLak Si/Thung Song Hong\tJanuary\t0.0\t0.05\tLak Si/Thung Song Hong (January)\t[0.0]\t[0.05]\t[0.0]\t[0.5285714285714286]\nSaphan Sung/Saphan Sung\tJanuary\t21.86\t0.05\tSaphan Sung/Saphan Sung (January)\t[21.86]\t[0.05]\t[0.14430947979931344]\t[0.5285714285714286]\nLat Phrao/Lat Phrao\tJanuary\t6.89\t1.04\tLat Phrao/Lat Phrao (January)\t[6.89]\t[1.04]\t[0.04548455241616055]\t[1.0]\nBang Khae/Bang Phai\tJanuary\t10.29\t0.26\tBang Khae/Bang Phai (January)\t[10.29]\t[0.26]\t[0.06792975970425139]\t[0.6285714285714286]\nPrawet/Nong Bon\tJanuary\t1.49\t0.05\tPrawet/Nong Bon (January)\t[1.49]\t[0.05]\t[0.009836282017428043]\t[0.5285714285714286]\nKhlong Toei/Khlong Toei\tJanuary\t0.0\t0.05\tKhlong Toei/Khlong Toei (January)\t[0.0]\t[0.05]\t[0.0]\t[0.5285714285714286]\nLat Krabang/Lam Pla Thio\tJanuary\t3.13\t-0.4\tLat Krabang/Lam Pla Thio (January)\t[3.13]\t[-0.4]\t[0.020662793768154213]\t[0.3142857142857143]\nBang Khun Thian/Samae Dam\tJanuary\t30.98\t0.26\tBang Khun Thian/Samae Dam (January)\t[30.98]\t[0.26]\t[0.20451544758383947]\t[0.6285714285714286]\nNong Chok/Krathum Rai\tJanuary\t15.51\t-0.4\tNong Chok/Krathum Rai (January)\t[15.51]\t[-0.4]\t[0.10238975442302614]\t[0.3142857142857143]\nBueng Kum/Khlong Kum\tJanuary\t6.42\t1.04\tBueng Kum/Khlong Kum (January)\t[6.42]\t[1.04]\t[0.04238183258515976]\t[1.0]\nLat Krabang/Khlong Sam Prawet\tJanuary\t16.01\t-0.4\tLat Krabang/Khlong Sam Prawet (January)\t[16.01]\t[-0.4]\t[0.10569052020068657]\t[0.3142857142857143]\nBang Khen/Tha Raeng\tJanuary\t1.89\t1.04\tBang Khen/Tha Raeng (January)\t[1.89]\t[1.04]\t[0.012476894639556377]\t[1.0]\nHuai Khwang/Bang Kapi\tJanuary\t3.7\t0.05\tHuai Khwang/Bang Kapi (January)\t[3.7]\t[0.05]\t[0.02442566675468709]\t[0.5285714285714286]\nLat Krabang/Khum Thong\tJanuary\t12.3\t-0.03\tLat Krabang/Khum Thong (January)\t[12.3]\t[-0.03]\t[0.08119883813044627]\t[0.49047619047619045]\nKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t1.25\t-0.03\tKhlong Sam Wa/Sam Wa Tawan Ok (January)\t[1.25]\t[-0.03]\t[0.008251914444151043]\t[0.49047619047619045]\nKhlong Toei/Khlong Toei\tJanuary\t0.0\t0.45\tKhlong Toei/Khlong Toei (January)\t[0.0]\t[0.45]\t[0.0]\t[0.719047619047619]\nKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t23.88\t-0.03\tKhlong Sam Wa/Sam Wa Tawan Tok (January)\t[23.88]\t[-0.03]\t[0.15764457354106154]\t[0.49047619047619045]\nDon Mueang/Sanam Bin\tJanuary\t0.0\t1.04\tDon Mueang/Sanam Bin (January)\t[0.0]\t[1.04]\t[0.0]\t[1.0]\nBang Khun Thian/Tha Kham\tJanuary\t24.1\t0.26\tBang Khun Thian/Tha Kham (January)\t[24.1]\t[0.26]\t[0.15909691048323213]\t[0.6285714285714286]\nNong Chok/Lam Phak Chi\tJanuary\t8.69\t-0.4\tNong Chok/Lam Phak Chi (January)\t[8.69]\t[-0.4]\t[0.05736730921573805]\t[0.3142857142857143]\nNong Chok/Khok Faet\tJanuary\t0.86\t-0.4\tNong Chok/Khok Faet (January)\t[0.86]\t[-0.4]\t[0.005677317137575918]\t[0.3142857142857143]\nKhlong Toei/Khlong Toei\tJuly\t38.4\t-0.13\tKhlong Toei/Khlong Toei (July)\t[38.4]\t[-0.13]\t[0.25349881172432004]\t[0.44285714285714284]\nKhlong Toei/Khlong Toei\tJuly\t125.76\t0.14\tKhlong Toei/Khlong Toei (July)\t[125.76]\t[0.14]\t[0.8302086083971483]\t[0.5714285714285715]\nKhlong Toei/Khlong Toei\tJune\t11.3\t-0.13\tKhlong Toei/Khlong Toei (June)\t[11.3]\t[-0.13]\t[0.07459730657512544]\t[0.44285714285714284]\nKhlong Toei/Khlong Toei\tJune\t63.43\t0.16\tKhlong Toei/Khlong Toei (June)\t[63.43]\t[0.16]\t[0.41873514655400057]\t[0.5809523809523809]\nLat Krabang/Lam Pla Thio\tMarch\t18.51\t-0.73\tLat Krabang/Lam Pla Thio (March)\t[18.51]\t[-0.73]\t[0.12219434908898866]\t[0.15714285714285717]\nBang Khun Thian/Tha Kham\tMarch\t5.92\t0.25\tBang Khun Thian/Tha Kham (March)\t[5.92]\t[0.25]\t[0.03908106680749934]\t[0.6238095238095238]\nDon Mueang/Sanam Bin\tMarch\t13.91\t0.96\tDon Mueang/Sanam Bin (March)\t[13.91]\t[0.96]\t[0.09182730393451281]\t[0.9619047619047618]\nLat Krabang/Khlong Sam Prawet\tMarch\t14.89\t-0.73\tLat Krabang/Khlong Sam Prawet (March)\t[14.89]\t[-0.73]\t[0.09829680485872723]\t[0.15714285714285717]\nLak Si/Thung Song Hong\tMarch\t2.68\t0.0\tLak Si/Thung Song Hong (March)\t[2.68]\t[0.0]\t[0.01769210456825984]\t[0.5047619047619047]\nSaphan Sung/Saphan Sung\tMarch\t21.35\t0.0\tSaphan Sung/Saphan Sung (March)\t[21.35]\t[0.0]\t[0.14094269870609982]\t[0.5047619047619047]\nLat Krabang/Khum Thong\tMarch\t4.08\t-0.07\tLat Krabang/Khum Thong (March)\t[4.08]\t[-0.07]\t[0.026934248745709006]\t[0.4714285714285714]\nNong Chok/Khu Fang Nuea\tMarch\t50.93\t0.52\tNong Chok/Khu Fang Nuea (March)\t[50.93]\t[0.52]\t[0.33621600211249014]\t[0.7523809523809524]\nKhlong Toei/Khlong Toei\tMarch\t0.2\t0.47\tKhlong Toei/Khlong Toei (March)\t[0.2]\t[0.47]\t[0.001320306311064167]\t[0.7285714285714285]\nHuai Khwang/Bang Kapi\tMarch\t28.91\t0.0\tHuai Khwang/Bang Kapi (March)\t[28.91]\t[0.0]\t[0.19085027726432532]\t[0.5047619047619047]\nMin Buri/Saen Saep\tMarch\t7.08\t-0.73\tMin Buri/Saen Saep (March)\t[7.08]\t[-0.73]\t[0.04673884341167151]\t[0.15714285714285717]\nBang Bon/Bang Bon\tMarch\t11.5\t0.25\tBang Bon/Bang Bon (March)\t[11.5]\t[0.25]\t[0.0759176128861896]\t[0.6238095238095238]\nNong Chok/Krathum Rai\tMarch\t2.25\t-0.73\tNong Chok/Krathum Rai (March)\t[2.25]\t[-0.73]\t[0.014853445999471878]\t[0.15714285714285717]\nLat Krabang/Lam Pla Thio\tMarch\t5.87\t-0.73\tLat Krabang/Lam Pla Thio (March)\t[5.87]\t[-0.73]\t[0.0387509902297333]\t[0.15714285714285717]\nKhlong Toei/Khlong Toei\tMarch\t47.7\t0.0\tKhlong Toei/Khlong Toei (March)\t[47.7]\t[0.0]\t[0.31489305518880384]\t[0.5047619047619047]\nBang Khae/Bang Phai\tMarch\t12.53\t0.25\tBang Khae/Bang Phai (March)\t[12.53]\t[0.25]\t[0.08271719038817006]\t[0.6238095238095238]\nBang Khen/Tha Raeng\tMarch\t20.86\t-0.07\tBang Khen/Tha Raeng (March)\t[20.86]\t[-0.07]\t[0.1377079482439926]\t[0.4714285714285714]\nKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t20.49\t-0.07\tKhlong Sam Wa/Sam Wa Tawan Tok (March)\t[20.49]\t[-0.07]\t[0.13526538156852388]\t[0.4714285714285714]\nNong Chok/Lam Phak Chi\tMarch\t34.99\t-0.73\tNong Chok/Lam Phak Chi (March)\t[34.99]\t[-0.73]\t[0.23098758912067602]\t[0.15714285714285717]\nBueng Kum/Khlong Kum\tMarch\t12.54\t0.96\tBueng Kum/Khlong Kum (March)\t[12.54]\t[0.96]\t[0.08278320570372326]\t[0.9619047619047618]\nPhaya Thai/Sam Sen Nai\tMarch\t13.01\t0.47\tPhaya Thai/Sam Sen Nai (March)\t[13.01]\t[0.47]\t[0.08588592553472406]\t[0.7285714285714285]\nKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t16.88\t-0.07\tKhlong Sam Wa/Sam Wa Tawan Ok (March)\t[16.88]\t[-0.07]\t[0.11143385265381568]\t[0.4714285714285714]\nNong Chok/Khlong Sip Song\tMarch\t12.41\t-0.73\tNong Chok/Khlong Sip Song (March)\t[12.41]\t[-0.73]\t[0.08192500660153156]\t[0.15714285714285717]\nBang Khen/Tha Raeng\tMarch\t6.09\t0.96\tBang Khen/Tha Raeng (March)\t[6.09]\t[0.96]\t[0.040203327171903884]\t[0.9619047619047618]\nLat Phrao/Lat Phrao\tMarch\t5.36\t0.96\tLat Phrao/Lat Phrao (March)\t[5.36]\t[0.96]\t[0.03538420913651968]\t[0.9619047619047618]\nNong Chok/Khok Faet\tMarch\t11.39\t-0.73\tNong Chok/Khok Faet (March)\t[11.39]\t[-0.73]\t[0.07519144441510431]\t[0.15714285714285717]\nPrawet/Nong Bon\tMarch\t15.28\t0.0\tPrawet/Nong Bon (March)\t[15.28]\t[0.0]\t[0.10087140216530235]\t[0.5047619047619047]\nBang Khun Thian/Samae Dam\tMarch\t23.66\t0.25\tBang Khun Thian/Samae Dam (March)\t[23.66]\t[0.25]\t[0.15619223659889095]\t[0.6238095238095238]\nSaphan Sung/Saphan Sung\tMay\t40.63\t-0.18\tSaphan Sung/Saphan Sung (May)\t[40.63]\t[-0.18]\t[0.26822022709268556]\t[0.41904761904761906]\nBang Khen/Tha Raeng\tMay\t114.27\t-0.1\tBang Khen/Tha Raeng (May)\t[114.27]\t[-0.1]\t[0.7543570108265117]\t[0.4571428571428572]\nKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t151.48\t-0.1\tKhlong Sam Wa/Sam Wa Tawan Ok (May)\t[151.48]\t[-0.1]\t[1.0]\t[0.4571428571428572]\nDon Mueang/Sanam Bin\tMay\t13.2\t0.87\tDon Mueang/Sanam Bin (May)\t[13.2]\t[0.87]\t[0.08714021653023502]\t[0.9190476190476191]\nLak Si/Thung Song Hong\tMay\t108.66\t-0.18\tLak Si/Thung Song Hong (May)\t[108.66]\t[-0.18]\t[0.7173224188011619]\t[0.41904761904761906]\nBang Bon/Bang Bon\tMay\t95.73\t0.16\tBang Bon/Bang Bon (May)\t[95.73]\t[0.16]\t[0.6319646157908636]\t[0.5809523809523809]\nMin Buri/Saen Saep\tMay\t33.45\t0.0\tMin Buri/Saen Saep (May)\t[33.45]\t[0.0]\t[0.22082123052548194]\t[0.5047619047619047]\nNong Chok/Khlong Sip Song\tMay\t35.91\t0.0\tNong Chok/Khlong Sip Song (May)\t[35.91]\t[0.0]\t[0.23706099815157117]\t[0.5047619047619047]\nLat Phrao/Lat Phrao\tMay\t40.74\t0.87\tLat Phrao/Lat Phrao (May)\t[40.74]\t[0.87]\t[0.2689463955637708]\t[0.9190476190476191]\nLat Krabang/Khlong Sam Prawet\tMay\t0.0\t0.0\tLat Krabang/Khlong Sam Prawet (May)\t[0.0]\t[0.0]\t[0.0]\t[0.5047619047619047]\nBang Khae/Bang Phai\tMay\t73.0\t0.16\tBang Khae/Bang Phai (May)\t[73.0]\t[0.16]\t[0.48191180353842095]\t[0.5809523809523809]\nNong Chok/Khu Fang Nuea\tMay\t84.03\t0.36\tNong Chok/Khu Fang Nuea (May)\t[84.03]\t[0.36]\t[0.5547266965936097]\t[0.6761904761904761]\nNong Chok/Krathum Rai\tMay\t107.71\t0.0\tNong Chok/Krathum Rai (May)\t[107.71]\t[0.0]\t[0.7110509638236071]\t[0.5047619047619047]\nBueng Kum/Khlong Kum\tMay\t18.6\t0.87\tBueng Kum/Khlong Kum (May)\t[18.6]\t[0.87]\t[0.12278848692896754]\t[0.9190476190476191]\nKhlong Toei/Khlong Toei\tMay\t46.4\t0.25\tKhlong Toei/Khlong Toei (May)\t[46.4]\t[0.25]\t[0.30631106416688675]\t[0.6238095238095238]\nPrawet/Nong Bon\tMay\t80.8\t-0.18\tPrawet/Nong Bon (May)\t[80.8]\t[-0.18]\t[0.5334037496699234]\t[0.41904761904761906]\nLat Krabang/Lam Pla Thio\tMay\t9.11\t0.0\tLat Krabang/Lam Pla Thio (May)\t[9.11]\t[0.0]\t[0.0601399524689728]\t[0.5047619047619047]\nHuai Khwang/Bang Kapi\tMay\t14.3\t-0.18\tHuai Khwang/Bang Kapi (May)\t[14.3]\t[-0.18]\t[0.09440190124108794]\t[0.41904761904761906]\nPhaya Thai/Sam Sen Nai\tMay\t53.0\t0.25\tPhaya Thai/Sam Sen Nai (May)\t[53.0]\t[0.25]\t[0.34988117243200423]\t[0.6238095238095238]\nBang Khen/Tha Raeng\tMay\t73.58\t0.87\tBang Khen/Tha Raeng (May)\t[73.58]\t[0.87]\t[0.485740691840507]\t[0.9190476190476191]\nKhlong Toei/Khlong Toei\tMay\t8.2\t-0.18\tKhlong Toei/Khlong Toei (May)\t[8.2]\t[-0.18]\t[0.05413255875363084]\t[0.41904761904761906]\nLat Krabang/Khum Thong\tMay\t59.66\t-0.1\tLat Krabang/Khum Thong (May)\t[59.66]\t[-0.1]\t[0.393847372590441]\t[0.4571428571428572]\nNong Chok/Khok Faet\tMay\t0.83\t0.0\tNong Chok/Khok Faet (May)\t[0.83]\t[0.0]\t[0.005479271190916292]\t[0.5047619047619047]\nBang Khun Thian/Tha Kham\tMay\t91.07\t0.16\tBang Khun Thian/Tha Kham (May)\t[91.07]\t[0.16]\t[0.6012014787430684]\t[0.5809523809523809]\nBang Khun Thian/Samae Dam\tMay\t96.8\t0.16\tBang Khun Thian/Samae Dam (May)\t[96.8]\t[0.16]\t[0.6390282545550569]\t[0.5809523809523809]\nNong Chok/Lam Phak Chi\tMay\t0.0\t0.0\tNong Chok/Lam Phak Chi (May)\t[0.0]\t[0.0]\t[0.0]\t[0.5047619047619047]\nLat Krabang/Lam Pla Thio\tMay\t90.92\t0.0\tLat Krabang/Lam Pla Thio (May)\t[90.92]\t[0.0]\t[0.6002112490097703]\t[0.5047619047619047]\nKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t91.25\t-0.1\tKhlong Sam Wa/Sam Wa Tawan Tok (May)\t[91.25]\t[-0.1]\t[0.6023897544230262]\t[0.4571428571428572]\nKhlong Toei/Khlong Toei\tNovember\t38.98\t0.33\tKhlong Toei/Khlong Toei (November)\t[38.98]\t[0.33]\t[0.25732770002640615]\t[0.6619047619047619]\nKhlong Toei/Khlong Toei\tNovember\t18.6\t0.0\tKhlong Toei/Khlong Toei (November)\t[18.6]\t[0.0]\t[0.12278848692896754]\t[0.5047619047619047]\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1604843174484_-1950021026","id":"20201108-134614_347786851","dateCreated":"2020-11-08T13:46:14+0000","dateStarted":"2020-11-08T14:34:46+0000","dateFinished":"2020-11-08T14:35:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"title":"5.1) Outlier Detection - Rainy Rate","text":"%pyspark\nimport pyspark.sql.functions as F\nfrom pyspark.sql.types import StringType\n\nsummaryDF = groupByMYDF.select(\"sum(DayRainyRate)\").summary(\"min\", \"max\", \"25%\", \"75%\", \"mean\", \"stddev\")\nmin = float(summaryDF.collect()[0][1])\nmax = float(summaryDF.collect()[1][1])\nq1 = float(summaryDF.collect()[2][1])\nq3 = float(summaryDF.collect()[3][1])\nmean = float(summaryDF.collect()[4][1])\nsd = float(summaryDF.collect()[5][1])\nsummaryDF.show()\n\niqr = q3-q1\nupperB = q3+(1.5*iqr)\nlowerB = q1-(1.5*iqr)\nprint \"IQR: {}\".format(iqr)\nprint \"Upper Bound: {} / Lower Bound: {}\".format(upperB, lowerB)\n\ndef checkBoundary(sumRate):\n    if sumRate > upperB: \n        return 'upper bound'\n    elif sumRate < lowerB:\n        return 'lower bound'\n    else :\n        return 'normal'\n\ncheckBoundaryFunc = F.udf(checkBoundary, StringType())\n\nOutlierDF = groupByMYDF.withColumn(\"Outlier\", checkBoundaryFunc(\"sum(DayRainyRate)\"))\nz.show(OutlierDF)","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Average_SummaryDayRainyRate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""},{"name":"MonthName","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"StationId","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"MonthNo","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"sum(DayRainyRate)","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Outlier","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"StationId":"string","Location":"string","MonthName":"string","MonthNo":"string","Year":"string","sum(DayRainyRate)":"string","Outlier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Location","index":0,"aggr":"sum"},"yAxis":{"name":"Outlier","index":5,"aggr":"sum"},"group":{"name":"MonthName","index":1,"aggr":"sum"}},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"rotate"}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"MonthName","index":1,"aggr":"sum"}],"values":[{"name":"Outlier","index":5,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary| sum(DayRainyRate)|\n+-------+------------------+\n|    min|               0.0|\n|    max|            151.48|\n|    25%|              5.16|\n|    75%|21.720000000000002|\n|   mean| 21.69893333333334|\n| stddev| 28.49236933398102|\n+-------+------------------+\n\nIQR: 16.56\nUpper Bound: 46.56 / Lower Bound: -19.68\n"},{"type":"TABLE","data":"StationId\tLocation\tMonthName\tMonthNo\tYear\tsum(DayRainyRate)\tOutlier\n4550019\tLat Krabang/Khlong Sam Prawet\tFebruary\t2\t2014\t22.789999999999996\tnormal\n4550025\tBang Khun Thian/Samae Dam\tJanuary\t1\t2014\t30.98\tnormal\n4550018\tSaphan Sung/Saphan Sung\tMay\t5\t2014\t40.63\tnormal\n4550004\tBang Khen/Tha Raeng\tMay\t5\t2014\t114.27\tupper bound\n4550016\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t18.51\tnormal\n4550004\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t0.0\tnormal\n4550026\tBang Khun Thian/Tha Kham\tMarch\t3\t2014\t5.92\tnormal\n4550026\tBang Khun Thian/Tha Kham\tApril\t4\t2014\t4.58\tnormal\n4550027\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t38.4\tnormal\n4550014\tNong Chok/Krathum Rai\tJanuary\t1\t2014\t15.510000000000002\tnormal\n4550001\tDon Mueang/Sanam Bin\tMarch\t3\t2014\t13.91\tnormal\n4550018\tSaphan Sung/Saphan Sung\tApril\t4\t2014\t19.36\tnormal\n4550011\tBueng Kum/Khlong Kum\tJanuary\t1\t2014\t6.42\tnormal\n4550024\tBang Bon/Bang Bon\tApril\t4\t2014\t8.02\tnormal\n4550011\tBueng Kum/Khlong Kum\tMay\t5\t2014\t18.6\tnormal\n4550010\tLat Phrao/Lat Phrao\tFebruary\t2\t2014\t3.64\tnormal\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t5\t2014\t151.48\tupper bound\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t3\t2014\t20.49\tnormal\n4550019\tLat Krabang/Khlong Sam Prawet\tMarch\t3\t2014\t14.89\tnormal\n4550002\tNong Chok/Khlong Sip Song\tApril\t4\t2014\t14.66\tnormal\n4550013\tNong Chok/Lam Phak Chi\tMarch\t3\t2014\t34.99000000000001\tnormal\n4550019\tLat Krabang/Khlong Sam Prawet\tJanuary\t1\t2014\t16.009999999999998\tnormal\n4550023\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t27.790000000000003\tnormal\n4550019\tLat Krabang/Khlong Sam Prawet\tApril\t4\t2014\t6.6\tnormal\n4550008\tBang Khen/Tha Raeng\tJanuary\t1\t2014\t1.89\tnormal\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t4\t2014\t5.3500000000000005\tnormal\n4550028\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t11.15\tnormal\n4550008\tBang Khen/Tha Raeng\tApril\t4\t2014\t2.45\tnormal\n4550028\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t46.4\tnormal\n4550027\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.0\tnormal\n4550021\tBang Khae/Bang Phai\tFebruary\t2\t2014\t5.59\tnormal\n4550020\tLat Krabang/Khum Thong\tFebruary\t2\t2014\t12.020000000000001\tnormal\n4550017\tHuai Khwang/Bang Kapi\tJanuary\t1\t2014\t3.6999999999999997\tnormal\n4550022\tPrawet/Nong Bon\tMay\t5\t2014\t80.8\tupper bound\n4550016\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t9.11\tnormal\n4550011\tBueng Kum/Khlong Kum\tMarch\t3\t2014\t12.540000000000001\tnormal\n4550017\tHuai Khwang/Bang Kapi\tMay\t5\t2014\t14.3\tnormal\n4550024\tBang Bon/Bang Bon\tJanuary\t1\t2014\t9.57\tnormal\n4550007\tNong Chok/Khu Fang Nuea\tApril\t4\t2014\t16.330000000000002\tnormal\n4550021\tBang Khae/Bang Phai\tApril\t4\t2014\t4.41\tnormal\n4550028\tKhlong Toei/Khlong Toei\tFebruary\t2\t2014\t1.8\tnormal\n4550027\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.9\tnormal\n4550008\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t5.16\tnormal\n4550020\tLat Krabang/Khum Thong\tApril\t4\t2014\t8.02\tnormal\n4550012\tMin Buri/Saen Saep\tJanuary\t1\t2014\t8.17\tnormal\n4550003\tLak Si/Thung Song Hong\tFebruary\t2\t2014\t12.719999999999999\tnormal\n4550001\tDon Mueang/Sanam Bin\tMay\t5\t2014\t13.2\tnormal\n4550015\tPhaya Thai/Sam Sen Nai\tJanuary\t1\t2014\t11.120000000000001\tnormal\n4550015\tPhaya Thai/Sam Sen Nai\tFebruary\t2\t2014\t11.93\tnormal\n4550007\tNong Chok/Khu Fang Nuea\tFebruary\t2\t2014\t3.2199999999999998\tnormal\n4550015\tPhaya Thai/Sam Sen Nai\tMarch\t3\t2014\t13.01\tnormal\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t3\t2014\t16.88\tnormal\n4550002\tNong Chok/Khlong Sip Song\tMarch\t3\t2014\t12.41\tnormal\n4550003\tLak Si/Thung Song Hong\tMarch\t3\t2014\t2.6799999999999997\tnormal\n4550018\tSaphan Sung/Saphan Sung\tFebruary\t2\t2014\t17.349999999999998\tnormal\n4550009\tNong Chok/Khok Faet\tApril\t4\t2014\t9.77\tnormal\n4550003\tLak Si/Thung Song Hong\tMay\t5\t2014\t108.66\tupper bound\n4550018\tSaphan Sung/Saphan Sung\tMarch\t3\t2014\t21.35\tnormal\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t2\t2014\t15.440000000000001\tnormal\n4550015\tPhaya Thai/Sam Sen Nai\tMay\t5\t2014\t53.0\tupper bound\n4550025\tBang Khun Thian/Samae Dam\tFebruary\t2\t2014\t18.759999999999998\tnormal\n4550007\tNong Chok/Khu Fang Nuea\tJanuary\t1\t2014\t0.99\tnormal\n4550008\tBang Khen/Tha Raeng\tMarch\t3\t2014\t6.09\tnormal\n4550002\tNong Chok/Khlong Sip Song\tJanuary\t1\t2014\t10.64\tnormal\n4550008\tBang Khen/Tha Raeng\tMay\t5\t2014\t73.58000000000001\tupper bound\n4550013\tNong Chok/Lam Phak Chi\tApril\t4\t2014\t14.37\tnormal\n4550003\tLak Si/Thung Song Hong\tJanuary\t1\t2014\t0.0\tnormal\n4550002\tNong Chok/Khlong Sip Song\tFebruary\t2\t2014\t16.79\tnormal\n4550024\tBang Bon/Bang Bon\tMay\t5\t2014\t95.72999999999999\tupper bound\n4550027\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t11.3\tnormal\n4550020\tLat Krabang/Khum Thong\tMarch\t3\t2014\t4.08\tnormal\n4550010\tLat Phrao/Lat Phrao\tApril\t4\t2014\t12.929999999999998\tnormal\n4550020\tLat Krabang/Khum Thong\tJanuary\t1\t2014\t12.299999999999999\tnormal\n4550011\tBueng Kum/Khlong Kum\tApril\t4\t2014\t0.0\tnormal\n4550028\tKhlong Toei/Khlong Toei\tJuly\t7\t2014\t125.76\tupper bound\n4550004\tBang Khen/Tha Raeng\tApril\t4\t2014\t7.6\tnormal\n4550018\tSaphan Sung/Saphan Sung\tJanuary\t1\t2014\t21.86\tnormal\n4550010\tLat Phrao/Lat Phrao\tMarch\t3\t2014\t5.359999999999999\tnormal\n4550007\tNong Chok/Khu Fang Nuea\tMarch\t3\t2014\t50.92999999999999\tupper bound\n4550010\tLat Phrao/Lat Phrao\tJanuary\t1\t2014\t6.890000000000001\tnormal\n4550027\tKhlong Toei/Khlong Toei\tMay\t5\t2014\t8.2\tnormal\n4550012\tMin Buri/Saen Saep\tMay\t5\t2014\t33.45\tnormal\n4550028\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t0.2\tnormal\n4550025\tBang Khun Thian/Samae Dam\tApril\t4\t2014\t21.43\tnormal\n4550002\tNong Chok/Khlong Sip Song\tMay\t5\t2014\t35.91\tnormal\n4550026\tBang Khun Thian/Tha Kham\tFebruary\t2\t2014\t16.220000000000002\tnormal\n4550027\tKhlong Toei/Khlong Toei\tAugust\t8\t2014\t5.0\tnormal\n4550016\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t9.13\tnormal\n4550021\tBang Khae/Bang Phai\tJanuary\t1\t2014\t10.29\tnormal\n4550004\tBang Khen/Tha Raeng\tFebruary\t2\t2014\t0.0\tnormal\n4550022\tPrawet/Nong Bon\tJanuary\t1\t2014\t1.49\tnormal\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t1\t2014\t1.25\tnormal\n4550009\tNong Chok/Khok Faet\tMarch\t3\t2014\t11.389999999999999\tnormal\n4550001\tDon Mueang/Sanam Bin\tFebruary\t2\t2014\t0.0\tnormal\n4550010\tLat Phrao/Lat Phrao\tMay\t5\t2014\t40.739999999999995\tnormal\n4550017\tHuai Khwang/Bang Kapi\tMarch\t3\t2014\t28.91\tnormal\n4550028\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t38.980000000000004\tnormal\n4550020\tLat Krabang/Khum Thong\tMay\t5\t2014\t59.660000000000004\tupper bound\n4550012\tMin Buri/Saen Saep\tMarch\t3\t2014\t7.08\tnormal\n4550019\tLat Krabang/Khlong Sam Prawet\tMay\t5\t2014\t0.0\tnormal\n4550022\tPrawet/Nong Bon\tFebruary\t2\t2014\t20.0\tnormal\n4550017\tHuai Khwang/Bang Kapi\tFebruary\t2\t2014\t20.73\tnormal\n4550009\tNong Chok/Khok Faet\tFebruary\t2\t2014\t16.52\tnormal\n4550024\tBang Bon/Bang Bon\tMarch\t3\t2014\t11.5\tnormal\n4550023\tLat Krabang/Lam Pla Thio\tFebruary\t2\t2014\t22.84\tnormal\n4550027\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\tnormal\n4550024\tBang Bon/Bang Bon\tFebruary\t2\t2014\t36.190000000000005\tnormal\n4550027\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\tnormal\n4550014\tNong Chok/Krathum Rai\tApril\t4\t2014\t12.76\tnormal\n4550021\tBang Khae/Bang Phai\tMay\t5\t2014\t73.0\tupper bound\n4550009\tNong Chok/Khok Faet\tMay\t5\t2014\t0.83\tnormal\n4550022\tPrawet/Nong Bon\tMarch\t3\t2014\t15.280000000000001\tnormal\n4550023\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t2.15\tnormal\n4550006\tKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t2\t2014\t15.720000000000002\tnormal\n4550028\tKhlong Toei/Khlong Toei\tJune\t6\t2014\t63.43\tupper bound\n4550026\tBang Khun Thian/Tha Kham\tMay\t5\t2014\t91.07\tupper bound\n4550028\tKhlong Toei/Khlong Toei\tApril\t4\t2014\t0.4\tnormal\n4550014\tNong Chok/Krathum Rai\tMarch\t3\t2014\t2.25\tnormal\n4550022\tPrawet/Nong Bon\tApril\t4\t2014\t14.629999999999997\tnormal\n4550028\tKhlong Toei/Khlong Toei\tJanuary\t1\t2014\t0.0\tnormal\n4550025\tBang Khun Thian/Samae Dam\tMay\t5\t2014\t96.8\tupper bound\n4550017\tHuai Khwang/Bang Kapi\tApril\t4\t2014\t6.710000000000001\tnormal\n4550016\tLat Krabang/Lam Pla Thio\tJanuary\t1\t2014\t3.13\tnormal\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t1\t2014\t23.880000000000003\tnormal\n4550013\tNong Chok/Lam Phak Chi\tFebruary\t2\t2014\t18.560000000000002\tnormal\n4550001\tDon Mueang/Sanam Bin\tJanuary\t1\t2014\t0.0\tnormal\n4550015\tPhaya Thai/Sam Sen Nai\tApril\t4\t2014\t7.359999999999999\tnormal\n4550027\tKhlong Toei/Khlong Toei\tNovember\t11\t2014\t18.599999999999998\tnormal\n4550026\tBang Khun Thian/Tha Kham\tJanuary\t1\t2014\t24.1\tnormal\n4550013\tNong Chok/Lam Phak Chi\tJanuary\t1\t2014\t8.690000000000001\tnormal\n4550012\tMin Buri/Saen Saep\tFebruary\t2\t2014\t20.330000000000002\tnormal\n4550028\tKhlong Toei/Khlong Toei\tDecember\t12\t2014\t0.0\tnormal\n4550013\tNong Chok/Lam Phak Chi\tMay\t5\t2014\t0.0\tnormal\n4550007\tNong Chok/Khu Fang Nuea\tMay\t5\t2014\t84.03\tupper bound\n4550011\tBueng Kum/Khlong Kum\tFebruary\t2\t2014\t11.6\tnormal\n4550016\tLat Krabang/Lam Pla Thio\tApril\t4\t2014\t11.23\tnormal\n4550023\tLat Krabang/Lam Pla Thio\tMarch\t3\t2014\t5.869999999999999\tnormal\n4550014\tNong Chok/Krathum Rai\tFebruary\t2\t2014\t3.2800000000000002\tnormal\n4550027\tKhlong Toei/Khlong Toei\tMarch\t3\t2014\t47.699999999999996\tupper bound\n4550001\tDon Mueang/Sanam Bin\tApril\t4\t2014\t9.47\tnormal\n4550023\tLat Krabang/Lam Pla Thio\tMay\t5\t2014\t90.91999999999999\tupper bound\n4550009\tNong Chok/Khok Faet\tJanuary\t1\t2014\t0.8600000000000001\tnormal\n4550003\tLak Si/Thung Song Hong\tApril\t4\t2014\t1.91\tnormal\n4550021\tBang Khae/Bang Phai\tMarch\t3\t2014\t12.530000000000001\tnormal\n4550014\tNong Chok/Krathum Rai\tMay\t5\t2014\t107.71000000000001\tupper bound\n4550012\tMin Buri/Saen Saep\tApril\t4\t2014\t21.720000000000002\tnormal\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t4\t2014\t5.64\tnormal\n4550005\tKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t5\t2014\t91.25\tupper bound\n4550025\tBang Khun Thian/Samae Dam\tMarch\t3\t2014\t23.66\tnormal\n4550004\tBang Khen/Tha Raeng\tMarch\t3\t2014\t20.859999999999996\tnormal\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1603634178174_-1976633791","id":"20201025-135618_251945645","dateCreated":"2020-10-25T13:56:18+0000","dateStarted":"2020-11-08T13:36:58+0000","dateFinished":"2020-11-08T13:37:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:390"},{"title":"5.2) Outlier Detection - Water level","text":"%pyspark\nfrom pyspark.sql.functions import col\n\ninYearDF = waterLevelFinalDF.select(\"Station\" ,(((col(\"1\")+col(\"2\")+col(\"3\")+col(\"4\")+col(\"5\")+col(\"6\")+col(\"7\")+col(\"8\")+col(\"9\")+col(\"10\")+col(\"11\")+col(\"12\"))/12)).alias(\"inYearAverage\"))\ninYearStatisticDF=inYearDF.select(\"inYearAverage\").summary(\"min\", \"max\", \"25%\", \"75%\", \"mean\", \"stddev\")\nminInYear = float(inYearStatisticDF.collect()[0][1])\nmaxInYear = float(inYearStatisticDF.collect()[1][1])\nq1InYear = float(inYearStatisticDF.collect()[2][1])\nq3InYear = float(inYearStatisticDF.collect()[3][1])\nmeanInYear = float(inYearStatisticDF.collect()[4][1])\nsdInYear = float(inYearStatisticDF.collect()[5][1])\ninYearStatisticDF.show()\n\niqrInYear = q3InYear-q1InYear\nupperBInYear = q3InYear+(1.5*iqrInYear)\nlowerBInYear = q1InYear-(1.5*iqrInYear)\nprint \"IQR: {}\".format(iqrInYear)\nprint \"Upper Bound: {} / Lower Bound: {}\".format(upperBInYear, lowerBInYear)\n\ndef checkBoundaryInYear(inYear):\n    if inYear > upperB: \n        return 'upper bound'\n    elif inYear < lowerB:\n        return 'lower bound'\n    else :\n        return 'normal'\n\ncheckBoundaryFunc = F.udf(checkBoundaryInYear, StringType())\noutlierInYearDF = inYearDF.withColumn(\"Outlier\", checkBoundaryFunc(\"inYearAverage\"))\noutlierInYearDF.show()","user":"anonymous","dateUpdated":"2020-11-08T14:25:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"1":"string","2":"string","3":"string","4":"string","5":"string","6":"string","7":"string","8":"string","9":"string","10":"string","11":"string","12":"string","Station":"string","allMonths":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Station":"string","inYear":"string","Outlier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+\n|summary|       inYearAverage|\n+-------+--------------------+\n|    min|-0.21126636949209213|\n|    max|   1.048509819739572|\n|    25%| 0.08805941624708387|\n|    75%| 0.38065521660052815|\n|   mean| 0.30638183549919973|\n| stddev| 0.37306760760637947|\n+-------+--------------------+\n\nIQR: 0.292595800353\nUpper Bound: 0.819548917131 / Lower Bound: -0.350834284283\n+-------+--------------------+-------+\n|Station|       inYearAverage|Outlier|\n+-------+--------------------+-------+\n| BKK001| 0.08805941624708387| normal|\n| BKK003|  0.6022614874018596| normal|\n| BKK004| 0.38065521660052815| normal|\n| BKK005|  0.2300304895068841| normal|\n| BKK008|-0.07427119291190218| normal|\n| BKK009|-0.21126636949209213| normal|\n| BKK020|  0.3493662443285259| normal|\n| BKK021|   1.048509819739572| normal|\n| CPY015|  0.3440914080723385| normal|\n+-------+--------------------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1604728848785_2142310530","id":"20201107-060048_938301864","dateCreated":"2020-11-07T06:00:48+0000","dateStarted":"2020-11-08T13:37:05+0000","dateFinished":"2020-11-08T13:40:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:391"}],"name":"flooding_project","id":"2FQA9YR6K","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
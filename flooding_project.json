{"paragraphs":[{"title":"1) Dataset Importing from HUE","text":"%pyspark\r\nhourlyData = spark.read.csv(\"/user/zeppelin/flooding_data/rainfall_hourly_data2.csv\", header=True, inferSchema=True)\r\n","user":"anonymous","dateUpdated":"2020-10-25T13:48:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=171","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=172"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1602925411281_1573475665","id":"20201017-090331_940034940","dateCreated":"2020-10-17T09:03:31+0000","dateStarted":"2020-10-25T13:48:44+0000","dateFinished":"2020-10-25T13:48:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14926","results":{"code":"SUCCESS","msg":[]}},{"title":"2.1) Data Preprocessing - Filter only Bangkok","text":"%pyspark\n#filter only \"Bangkok\" province and assign to valiable 'bangkokHourlyData'\nbangkokHourlyData = hourlyData.filter(hourlyData['province_name_en']==\"Bangkok\").select(hourlyData['province_name_en'], hourlyData['district'], hourlyData['sub_district'], hourlyData['date'],  hourlyData['H01'], hourlyData['H02'], hourlyData['H03'], hourlyData['H04'], hourlyData['H05'], hourlyData['H06'], hourlyData['H07'], hourlyData['H08'], hourlyData['H09'], hourlyData['H10'], hourlyData['H11'], hourlyData['H12'], hourlyData['H13'], hourlyData['H14'], hourlyData['H15'], hourlyData['H16'], hourlyData['H17'], hourlyData['H18'], hourlyData['H19'], hourlyData['H20'], hourlyData['H21'], hourlyData['H22'], hourlyData['H23'], hourlyData['H24'])","user":"anonymous","dateUpdated":"2020-10-25T13:48:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"province_name_en","visible":true,"width":"*","sort":{"direction":"asc","priority":0},"filters":[{}],"pinned":""},{"name":"district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"sub_district","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H01","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H02","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H03","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H04","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H05","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H06","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H07","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H08","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H09","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H10","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H11","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H12","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H13","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H14","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H15","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H16","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H17","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H18","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H19","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H20","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H21","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H22","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H23","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"H24","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[{"field":"province_name_en","groupPriority":0,"colName":"province_name_en"}],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"province_name_en":"string","district":"string","sub_district":"string","date":"string","H01":"string","H02":"string","H03":"string","H04":"string","H05":"string","H06":"string","H07":"string","H08":"string","H09":"string","H10":"string","H11":"string","H12":"string","H13":"string","H14":"string","H15":"string","H16":"string","H17":"string","H18":"string","H19":"string","H20":"string","H21":"string","H22":"string","H23":"string","H24":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1602925420895_-1295208824","id":"20201017-090340_1507830950","dateCreated":"2020-10-17T09:03:40+0000","dateStarted":"2020-10-25T13:48:46+0000","dateFinished":"2020-10-25T13:48:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14927","results":{"code":"SUCCESS","msg":[]}},{"title":"2.2) Missing Value (Statistical value of known data): calculate average rainy rate of each that day","text":"%pyspark\n#calculate the number of rainy hours on that day. (rainy hour = 24 - dry hour)\nimport datetime\n\nrainyHourArray = []\n\nclass RainyHour:\n    \n    def __init__(self, district, subDistrict, date, totalRainyHour, summaryRainyRate):\n        self.key = str(abs(hash(district+subDistrict)))\n        self.location = str(district + \"/\" + subDistrict)\n        self.day = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n        self.month = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n        self.year = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n        self.totalRainyHour = totalRainyHour\n        self.summaryRainyRate = summaryRainyRate\n        self.averageRainyRate = self.calAvg()\n    \n    def info(self):\n        return (self.key, self.location, self.day, self.month, self.year, self.totalRainyHour, self.summaryRainyRate, self.averageRainyRate)\n    \n    def calAvg(self):\n        if self.totalRainyHour!=0 and self.summaryRainyRate>0.0: \n            return round(self.summaryRainyRate / self.totalRainyHour, 2)\n        else:\n            return 0\n\ndef calculateRainyHour(row):\n    rainyHour=24\n    summaryRainyRate = 0.0\n    \n    for i in range(1, 25):\n        colName= \"H0\"+str(i) if i<=9 else \"H\"+str(i)\n        \n        if row[colName]!=\"NULL\" and float(row[colName])==0.0:\n            rainyHour-=1\n\n        if row[colName]!=\"NULL\" : summaryRainyRate+=float(row[colName])\n            \n    return RainyHour(row['district'], row['sub_district'], row['date'], rainyHour, summaryRainyRate)\n\n\nfor row in bangkokHourlyData.rdd.collect():\n    r = calculateRainyHour(row)\n    rainyHourArray.append(r.info())\n\ndef getAvgRainyRateByLocationAndDate(district, subDistrict, date):\n    row = 0.0\n    keyIn = str(abs(hash(district+subDistrict)))\n    dayIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().day)\n    monthIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().month)\n    yearIn = str(datetime.datetime.strptime(date, \"%d/%m/%Y\").date().year)\n    \n    for r in rainyHourArray:\n        if r[0]==keyIn and r[2]==dayIn and r[3]==monthIn and r[4]==yearIn:\n            row =  r[7]\n    \n    return row\n","user":"anonymous","dateUpdated":"2020-10-25T13:48:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"yAxis":{"name":"NumberOfRainyHour","index":3,"aggr":"sum"},"size":{"name":"Location","index":1,"aggr":"sum"},"xAxis":{"name":"Location","index":1,"aggr":"sum"}},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Key","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"NumberOfRainyHour","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Key":"string","Location":"string","Date":"string","NumberOfRainyHour":"number"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Key","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Location","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=173"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603029858134_-1147608560","id":"20201018-140418_1176902503","dateCreated":"2020-10-18T14:04:18+0000","dateStarted":"2020-10-25T13:48:46+0000","dateFinished":"2020-10-25T13:48:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14928","results":{"code":"SUCCESS","msg":[]}},{"title":"2.3) Missing value (Statistical value of known data) - Replace NULL with average rainy rate of each that day","text":"%pyspark\n#statistics = getAvgRainyRateByLocationAndDate('Khlong Toei', 'Khlong Toei', '16/7/2014')\n#print average rate: {}\".format(statistics)\n\ndef replaceNullWithAvg(row):\n    avgRainyRate = getAvgRainyRateByLocationAndDate(row['district'], row['sub_district'], row['date'])\n    return (\n        float(avgRainyRate if row['H01']==\"NULL\" else row['H01']),\n        float(avgRainyRate if row['H02']==\"NULL\" else row['H02']),\n        float(avgRainyRate if row['H03']==\"NULL\" else row['H03']),\n        float(avgRainyRate if row['H04']==\"NULL\" else row['H04']),\n        float(avgRainyRate if row['H05']==\"NULL\" else row['H05']),\n        float(avgRainyRate if row['H06']==\"NULL\" else row['H06']),\n        float(avgRainyRate if row['H07']==\"NULL\" else row['H07']),\n        float(avgRainyRate if row['H08']==\"NULL\" else row['H08']),\n        float(avgRainyRate if row['H09']==\"NULL\" else row['H09']),\n        float(avgRainyRate if row['H10']==\"NULL\" else row['H10']),\n        float(avgRainyRate if row['H11']==\"NULL\" else row['H11']),\n        float(avgRainyRate if row['H12']==\"NULL\" else row['H12']),\n        float(avgRainyRate if row['H13']==\"NULL\" else row['H13']),\n        float(avgRainyRate if row['H14']==\"NULL\" else row['H14']),\n        float(avgRainyRate if row['H15']==\"NULL\" else row['H15']),\n        float(avgRainyRate if row['H16']==\"NULL\" else row['H16']),\n        float(avgRainyRate if row['H17']==\"NULL\" else row['H17']),\n        float(avgRainyRate if row['H18']==\"NULL\" else row['H18']),\n        float(avgRainyRate if row['H19']==\"NULL\" else row['H19']),\n        float(avgRainyRate if row['H20']==\"NULL\" else row['H20']),\n        float(avgRainyRate if row['H21']==\"NULL\" else row['H21']),\n        float(avgRainyRate if row['H22']==\"NULL\" else row['H22']),\n        float(avgRainyRate if row['H23']==\"NULL\" else row['H23']),\n        float(avgRainyRate if row['H24']==\"NULL\" else row['H24'])\n    )\n\ndef extract(row):\n    rowDate = row['date']\n    day = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().day)\n    month = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().month)\n    year = str(datetime.datetime.strptime(rowDate, \"%d/%m/%Y\").date().year)\n    \n    return (\n        row['district'] + \"/\" + row['sub_district'], day, month, year, replaceNullWithAvg(row)\n    )\n\n\ncleanDF=bangkokHourlyData.rdd.map(extract).toDF(['Location','Day','Month', 'Year', 'RainyRates'])\n","user":"anonymous","dateUpdated":"2020-10-25T13:48:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"Location","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Day","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Month","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"RainyHours","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyHours":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"scatterChart":{"xAxis":{"name":"Location","index":0,"aggr":"sum"}}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[{"name":"Month","index":2,"aggr":"sum"}],"values":[{"name":"RainyHours","index":4,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=174"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603523563777_1375166502","id":"20201024-071243_435153083","dateCreated":"2020-10-24T07:12:43+0000","dateStarted":"2020-10-25T13:48:48+0000","dateFinished":"2020-10-25T13:48:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14929","results":{"code":"SUCCESS","msg":[]}},{"title":"2.4) Missing value - Check rainy rate since 01:00 till 24:00 should not be NULL","text":"%pyspark\nfor row in cleanDF.rdd.collect():\n    hourRow = row['RainyRates']\n    for i in range(0, 23):\n        assert \"True\" == str((hourRow[i] != \"NULL\"))","user":"anonymous","dateUpdated":"2020-10-25T13:48:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=175"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603611944566_-1555939565","id":"20201025-074544_914445690","dateCreated":"2020-10-25T07:45:44+0000","dateStarted":"2020-10-25T13:48:49+0000","dateFinished":"2020-10-25T13:48:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14930","results":{"code":"SUCCESS","msg":[]}},{"title":"3.1) Mapping - Finding summary and average rainy rate each that day","text":"%pyspark\nmonthsArray = [\"none\", \"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\ndef summaryRainyRate(row):\n    summaryRate = 0.0\n    hourRow = row['RainyRates']\n    result = [row['Location'], row['Day'], monthsArray[int(row['Month'])], row['Year'], row['RainyRates'], ]\n    for i in range(0, 23):\n        summaryRate+=hourRow[i]\n    result.append(float(summaryRate))\n    return result\n    \nsummaryDF = cleanDF.rdd.map(summaryRainyRate).toDF([\"Location\",\"Day\",\"Month\",\"Year\",\"RainyRate\", \"DayRainyRate\"])\nsummaryDF.show()","user":"anonymous","dateUpdated":"2020-10-25T13:48:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Day":"string","Month":"string","Year":"string","RainyRate":"string","SummaryRainyRate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=176","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=177"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603622037681_330666540","id":"20201025-103357_826461112","dateCreated":"2020-10-25T10:33:57+0000","dateStarted":"2020-10-25T13:48:51+0000","dateFinished":"2020-10-25T13:48:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14932","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+--------+----+--------------------+------------+\n|            Location|Day|   Month|Year|           RainyRate|DayRainyRate|\n+--------------------+---+--------+----+--------------------+------------+\n|Don Mueang/Sanam Bin|  1| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  2| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  3| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  4| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  5| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  6| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  7| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  8| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  9| January|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  1|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  2|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  3|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  4|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  5|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  6|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  7|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  8|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  9|February|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  1|   March|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n|Don Mueang/Sanam Bin|  2|   March|2014|[0.0, 0.0, 0.0, 0...|         0.0|\n+--------------------+---+--------+----+--------------------+------------+\nonly showing top 20 rows\n\n"}]}},{"title":"4) Reduce - Summary rainy rate by month and year","text":"%pyspark\ngroupByMYDF = summaryDF.groupBy([\"Location\", \"Month\", \"Year\"]).sum(\"DayRainyRate\")\nz.show(groupByMYDF)","user":"anonymous","dateUpdated":"2020-10-25T13:53:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Location":"string","Month":"string","Year":"string","sum(DayRainyRate)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"scatterChart":{"xAxis":{"name":"Month","index":1,"aggr":"sum"},"size":{"name":"sum(DayRainyRate)","index":3,"aggr":"sum"},"group":{"name":"Location","index":0,"aggr":"sum"},"yAxis":{"name":"sum(DayRainyRate)","index":3,"aggr":"sum"}},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","isDateFormat":false,"lineWithFocus":false,"forceY":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"keys":[{"name":"Location","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(DayRainyRate)","index":3,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=178","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=179","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=180","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=181","http://hadoop-cluster-2020-msc-m.us-central1-f.c.meta-plateau-287204.internal:4040/jobs/job?id=182"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1603624634837_-122743207","id":"20201025-111714_732506377","dateCreated":"2020-10-25T11:17:14+0000","dateStarted":"2020-10-25T13:48:54+0000","dateFinished":"2020-10-25T13:49:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14933","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Location\tMonth\tYear\tsum(DayRainyRate)\nBang Khun Thian/Samae Dam\tFebruary\t2014\t18.76\nNong Chok/Khu Fang Nuea\tMarch\t2014\t50.92999999999999\nLat Phrao/Lat Phrao\tMay\t2014\t40.739999999999995\nLak Si/Thung Song Hong\tApril\t2014\t1.91\nBang Bon/Bang Bon\tMarch\t2014\t11.5\nLat Krabang/Khum Thong\tJanuary\t2014\t12.299999999999999\nLat Krabang/Khlong Sam Prawet\tJanuary\t2014\t16.009999999999998\nBang Bon/Bang Bon\tFebruary\t2014\t36.190000000000005\nKhlong Toei/Khlong Toei\tApril\t2014\t1.2999999999999998\nNong Chok/Lam Phak Chi\tMarch\t2014\t34.989999999999995\nLat Krabang/Lam Pla Thio\tFebruary\t2014\t31.97\nLak Si/Thung Song Hong\tMay\t2014\t108.66\nBueng Kum/Khlong Kum\tMarch\t2014\t12.54\nPhaya Thai/Sam Sen Nai\tApril\t2014\t7.359999999999999\nBang Khun Thian/Samae Dam\tApril\t2014\t21.43\nPhaya Thai/Sam Sen Nai\tMay\t2014\t52.99999999999999\nKhlong Toei/Khlong Toei\tAugust\t2014\t16.15\nKhlong Sam Wa/Sam Wa Tawan Tok\tApril\t2014\t5.64\nNong Chok/Khok Faet\tJanuary\t2014\t0.8600000000000001\nMin Buri/Saen Saep\tApril\t2014\t21.72\nBang Khun Thian/Samae Dam\tJanuary\t2014\t30.98\nPhaya Thai/Sam Sen Nai\tFebruary\t2014\t11.93\nHuai Khwang/Bang Kapi\tApril\t2014\t6.71\nHuai Khwang/Bang Kapi\tMarch\t2014\t28.909999999999997\nBang Khen/Tha Raeng\tJanuary\t2014\t1.89\nNong Chok/Krathum Rai\tJanuary\t2014\t15.510000000000002\nHuai Khwang/Bang Kapi\tFebruary\t2014\t20.73\nBang Khun Thian/Samae Dam\tMarch\t2014\t23.66\nKhlong Sam Wa/Sam Wa Tawan Ok\tFebruary\t2014\t15.719999999999999\nLat Krabang/Lam Pla Thio\tJanuary\t2014\t30.919999999999998\nNong Chok/Khlong Sip Song\tMay\t2014\t35.910000000000004\nKhlong Sam Wa/Sam Wa Tawan Tok\tFebruary\t2014\t15.44\nLat Krabang/Lam Pla Thio\tApril\t2014\t13.38\nLat Krabang/Khlong Sam Prawet\tApril\t2014\t6.6\nBang Khae/Bang Phai\tMarch\t2014\t12.530000000000001\nKhlong Sam Wa/Sam Wa Tawan Ok\tMay\t2014\t151.47999999999996\nDon Mueang/Sanam Bin\tApril\t2014\t9.47\nKhlong Sam Wa/Sam Wa Tawan Tok\tMay\t2014\t91.25\nKhlong Toei/Khlong Toei\tFebruary\t2014\t2.8\nMin Buri/Saen Saep\tFebruary\t2014\t20.330000000000002\nHuai Khwang/Bang Kapi\tMay\t2014\t14.3\nKhlong Toei/Khlong Toei\tJuly\t2014\t164.16\nLat Krabang/Khlong Sam Prawet\tFebruary\t2014\t22.79\nBang Khae/Bang Phai\tJanuary\t2014\t10.29\nNong Chok/Khlong Sip Song\tFebruary\t2014\t16.79\nDon Mueang/Sanam Bin\tMarch\t2014\t13.91\nMin Buri/Saen Saep\tMarch\t2014\t7.08\nNong Chok/Lam Phak Chi\tFebruary\t2014\t18.56\nNong Chok/Khlong Sip Song\tMarch\t2014\t12.41\nSaphan Sung/Saphan Sung\tMarch\t2014\t21.349999999999998\nKhlong Sam Wa/Sam Wa Tawan Ok\tApril\t2014\t5.35\nPhaya Thai/Sam Sen Nai\tJanuary\t2014\t11.120000000000001\nBueng Kum/Khlong Kum\tMay\t2014\t18.599999999999998\nPrawet/Nong Bon\tMay\t2014\t80.80000000000001\nNong Chok/Khu Fang Nuea\tMay\t2014\t84.03000000000002\nBueng Kum/Khlong Kum\tJanuary\t2014\t6.42\nDon Mueang/Sanam Bin\tJanuary\t2014\t0.0\nBang Khun Thian/Tha Kham\tJanuary\t2014\t24.099999999999998\nLat Krabang/Lam Pla Thio\tMarch\t2014\t24.380000000000003\nSaphan Sung/Saphan Sung\tApril\t2014\t19.36\nNong Chok/Krathum Rai\tFebruary\t2014\t3.2800000000000002\nPhaya Thai/Sam Sen Nai\tMarch\t2014\t13.010000000000002\nBang Khun Thian/Samae Dam\tMay\t2014\t96.80000000000001\nNong Chok/Krathum Rai\tMay\t2014\t107.71000000000001\nLat Krabang/Khum Thong\tApril\t2014\t8.02\nNong Chok/Khok Faet\tFebruary\t2014\t16.52\nNong Chok/Khu Fang Nuea\tApril\t2014\t16.330000000000002\nLat Krabang/Khlong Sam Prawet\tMarch\t2014\t14.89\nBang Khun Thian/Tha Kham\tFebruary\t2014\t16.220000000000002\nLak Si/Thung Song Hong\tMarch\t2014\t2.68\nBang Bon/Bang Bon\tApril\t2014\t8.02\nSaphan Sung/Saphan Sung\tFebruary\t2014\t17.35\nLat Krabang/Khlong Sam Prawet\tMay\t2014\t0.0\nLat Krabang/Khum Thong\tMay\t2014\t59.66\nLat Phrao/Lat Phrao\tJanuary\t2014\t6.89\nSaphan Sung/Saphan Sung\tJanuary\t2014\t21.860000000000003\nBang Khen/Tha Raeng\tFebruary\t2014\t5.16\nKhlong Sam Wa/Sam Wa Tawan Ok\tJanuary\t2014\t1.25\nKhlong Toei/Khlong Toei\tDecember\t2014\t0.0\nBang Bon/Bang Bon\tJanuary\t2014\t9.57\nLat Phrao/Lat Phrao\tFebruary\t2014\t3.64\nNong Chok/Khu Fang Nuea\tJanuary\t2014\t0.99\nBang Khae/Bang Phai\tApril\t2014\t4.41\nLak Si/Thung Song Hong\tFebruary\t2014\t12.719999999999999\nNong Chok/Khok Faet\tMarch\t2014\t11.39\nMin Buri/Saen Saep\tMay\t2014\t33.45\nDon Mueang/Sanam Bin\tFebruary\t2014\t0.0\nNong Chok/Krathum Rai\tApril\t2014\t12.76\nKhlong Toei/Khlong Toei\tJune\t2014\t74.73\nLat Phrao/Lat Phrao\tApril\t2014\t12.93\nNong Chok/Khu Fang Nuea\tFebruary\t2014\t3.2199999999999998\nBang Khen/Tha Raeng\tMay\t2014\t187.85000000000002\nNong Chok/Krathum Rai\tMarch\t2014\t2.25\nLat Krabang/Lam Pla Thio\tMay\t2014\t100.03\nBueng Kum/Khlong Kum\tFebruary\t2014\t11.6\nPrawet/Nong Bon\tApril\t2014\t14.629999999999999\nKhlong Sam Wa/Sam Wa Tawan Tok\tJanuary\t2014\t23.880000000000003\nKhlong Toei/Khlong Toei\tJanuary\t2014\t0.0\nHuai Khwang/Bang Kapi\tJanuary\t2014\t3.6999999999999997\nLat Krabang/Khum Thong\tFebruary\t2014\t12.02\nPrawet/Nong Bon\tFebruary\t2014\t20.0\nKhlong Toei/Khlong Toei\tMay\t2014\t54.60000000000001\nBang Khen/Tha Raeng\tMarch\t2014\t26.95\nNong Chok/Khok Faet\tApril\t2014\t9.77\nLat Phrao/Lat Phrao\tMarch\t2014\t5.359999999999999\nNong Chok/Lam Phak Chi\tApril\t2014\t14.37\nBueng Kum/Khlong Kum\tApril\t2014\t0.0\nNong Chok/Lam Phak Chi\tJanuary\t2014\t8.690000000000001\nBang Bon/Bang Bon\tMay\t2014\t95.72999999999999\nKhlong Toei/Khlong Toei\tNovember\t2014\t57.58\nBang Khun Thian/Tha Kham\tMarch\t2014\t5.92\nLak Si/Thung Song Hong\tJanuary\t2014\t0.0\nBang Khen/Tha Raeng\tApril\t2014\t10.05\nPrawet/Nong Bon\tJanuary\t2014\t1.49\nBang Khae/Bang Phai\tFebruary\t2014\t5.59\nNong Chok/Khlong Sip Song\tJanuary\t2014\t10.64\nKhlong Sam Wa/Sam Wa Tawan Tok\tMarch\t2014\t20.490000000000002\nDon Mueang/Sanam Bin\tMay\t2014\t13.2\nBang Khun Thian/Tha Kham\tMay\t2014\t91.07\nKhlong Sam Wa/Sam Wa Tawan Ok\tMarch\t2014\t16.880000000000003\nBang Khae/Bang Phai\tMay\t2014\t73.0\nLat Krabang/Khum Thong\tMarch\t2014\t4.08\nMin Buri/Saen Saep\tJanuary\t2014\t8.17\nPrawet/Nong Bon\tMarch\t2014\t15.28\nNong Chok/Lam Phak Chi\tMay\t2014\t0.0\nNong Chok/Khlong Sip Song\tApril\t2014\t14.660000000000002\nSaphan Sung/Saphan Sung\tMay\t2014\t40.63\nNong Chok/Khok Faet\tMay\t2014\t0.83\nBang Khun Thian/Tha Kham\tApril\t2014\t4.58\nKhlong Toei/Khlong Toei\tMarch\t2014\t47.9\n"},{"type":"TEXT","data":"\n"}]}}],"name":"flooding_project","id":"2FQA9YR6K","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}